<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Welcome | 张亚超的技术博客YACHAO&#39;Blog</title>
  <subtitle>每一个不起眼的瞬间都是对生命的辜负！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://devchao.com/"/>
  <updated>2017-12-05T03:27:36.000Z</updated>
  <id>https://devchao.com/</id>
  
  <author>
    <name>DevChao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>iOS-串行并行同步异步</title>
    <link href="https://devchao.com/2017/12/05/iOS-%E4%B8%B2%E8%A1%8C%E5%B9%B6%E8%A1%8C%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5/"/>
    <id>https://devchao.com/2017/12/05/iOS-串行并行同步异步/</id>
    <published>2017-12-05T03:27:06.000Z</published>
    <updated>2017-12-05T03:27:36.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iOS-串行-并行-同步-异步"><a href="#iOS-串行-并行-同步-异步" class="headerlink" title="iOS 串行 并行 同步 异步"></a>iOS 串行 并行 同步 异步</h1><blockquote>
<p>队列分为串行和并行</p>
<p>任务的执行分为同步和异步</p>
</blockquote>
<p>这两两组合就成为了串行队列同步执行，串行队列异步执行，并行队列同步执行，并行队列异步执行</p>
<p>而异步是多线程的代名词，异步在实际引用中会开启新的线程，执行耗时操作。</p>
<p>那我们先来知道一个非常重要的事情：</p>
<p>——-  队列只是负责任务的调度，而不负责任务的执行   ———</p>
<p>——- 任务是在线程中执行的  ———</p>
<blockquote>
<p>队列和任务的特点：</p>
</blockquote>
<p>队列的特点：先进先出，排在前面的任务最先执行，</p>
<p>串行队列：任务按照顺序被调度，前一个任务不执行完毕，队列不会调度</p>
<p>并行队列：只要有空闲的线程，队列就会调度当前任务，交给线程去执行，不需要考虑前面是都有任务在执行，只要有线程可以利用，队列就会调度任务。</p>
<p>主队列：专门用来在主线程调度任务的队列，所以主队列的任务都要在主线程来执行，主队列会随着程序的启动一起创建，我们只需get即可</p>
<p>全局队列：是系统为了方便程序员开发提供的，其工作表现与并发队列一致，那么全局队列跟并发队列的区别是什么呢？</p>
<p>1.全局队列：无论ARC还是MRC都不需要考录释放，因为系统提供的我们只需要get就可以了</p>
<p>2.并发队列：再MRC下，并发队列创建出来后，需要手动释放dispatch_release()</p>
<p>同步执行：不会开启新的线程，任务按顺序执行</p>
<p>异步执行：会开启新的线程，任务可以并发的执行</p>
<blockquote>
<p>那么有这么几种组合:</p>
</blockquote>
<ul>
<li>串行队列同步执行：综合上面阐述的串行队列的特点 — 按顺序执行，同步：不会开启新的线程，则串行队列同步执行只是按部就班的one by one执行。</li>
<li>串行队列异步执行：虽然队列中存放的是异步执行的任务，但是结合串行队列的特点，前一个任务不执行完毕，队列不会调度，所以串行队列异步执行也是one by one的执行</li>
<li>并行队列同步执行：结合上面阐述的并行队列的特点，和同步执行的特点，可以明确的分析出来，虽然并行队列可以不需等待前一个任务执行完毕就可调度下一个任务，但是任务同步执行不会开启新的线程，所以任务也是one by one的执行</li>
<li>并行队列异步执行：再上一条中说明了并行队列的特点，而异步执行是任务可以开启新的线程，所以这中组合可以实现任务的并发，再实际开发中也是经常会用到的</li>
</ul>
<blockquote>
<p>GCD实现原理:</p>
</blockquote>
<p>GCD有一个底层线程池，这个池中存放的是一个个的线程。之所以称为“池”，很容易理解出这个“池”中的线程是可以重用的，当一段时间后这个线程没有被调用胡话，这个线程就会被销毁。注意：开多少条线程是由底层线程池决、、、、、定的（线程建议控制再3~5条），池是系统自动来维护，不需要我们程序员来维护（看到这句话是不是很开心？）</p>
<p>而我们程序员需要关心的是什么呢？我们只关心的是向队列中添加任务，队列调度即可。</p>
<ul>
<li><p>如果队列中存放的是同步任务，则任务出队后，底层线程池中会提供一条线程供这个任务执行，任务执行完毕后这条线程再回到线程池。这样队列中的任务反复调度，因为是同步的，所以当我们用currentThread打印的时候，就是同一条线程。</p>
</li>
<li><p>如果队列中存放的是异步的任务，（注意异步可以开线程），当任务出队后，底层线程池会提供一个线程供任务执行，因为是异步执行，队列中的任务不需等待当前任务执行完毕就可以调度下一个任务，这时底层线程池中会再次提供一个线程供第二个任务执行，执行完毕后再回到底层线程池中。</p>
</li>
<li><p>这样就对线程完成一个复用，而不需要每一个任务执行都开启新的线程，也就从而节约的系统的开销，提高了效率。在iOS7.0的时候，使用GCD系统通常只能开5~8条线程，iOS8.0以后，系统可以开启很多条线程，但是实在开发应用中，建议开启线程条数：3~5条最为合理。</p>
</li>
</ul>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;iOS-串行-并行-同步-异步&quot;&gt;&lt;a href=&quot;#iOS-串行-并行-同步-异步&quot; class=&quot;headerlink&quot; title=&quot;iOS 串行 并行 同步 异步&quot;&gt;&lt;/a&gt;iOS 串行 并行 同步 异步&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;队列分为串
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>iOS修改系统时间颜色</title>
    <link href="https://devchao.com/2017/11/30/iOS%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E9%A2%9C%E8%89%B2/"/>
    <id>https://devchao.com/2017/11/30/iOS修改系统时间颜色/</id>
    <published>2017-11-30T05:39:41.000Z</published>
    <updated>2017-11-30T05:40:10.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iOS-修改系统时间颜色"><a href="#iOS-修改系统时间颜色" class="headerlink" title="iOS 修改系统时间颜色"></a>iOS 修改系统时间颜色</h1><p><strong>做法</strong></p>
<p>在info-plist 中加入View controller-based status bar appearance键值对</p>
<blockquote>
<p>NO: 意思是由系统控制<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[UIApplicationsharedApplication].statusBarStyle = **</div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>YES: statusBar的控制权交给了各自的控制器</p>
<p>在控制器中实现preferredStatusBarStyle方法，直接返回需要的状态栏设置</p>
</blockquote>
<p><strong>代码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[UIApplicationsharedApplication].statusBarStyle =UIStatusBarStyleLightContent;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-(UIStatusBarStyle)preferredStatusBarStyle&#123;</div><div class="line">    return UIStatusBarStyleLightContent;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;iOS-修改系统时间颜色&quot;&gt;&lt;a href=&quot;#iOS-修改系统时间颜色&quot; class=&quot;headerlink&quot; title=&quot;iOS 修改系统时间颜色&quot;&gt;&lt;/a&gt;iOS 修改系统时间颜色&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;做法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在in
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>启用Mac自带的php</title>
    <link href="https://devchao.com/2017/09/08/%E5%90%AF%E7%94%A8Mac%E8%87%AA%E5%B8%A6%E7%9A%84php/"/>
    <id>https://devchao.com/2017/09/08/启用Mac自带的php/</id>
    <published>2017-09-08T07:20:18.000Z</published>
    <updated>2017-09-08T07:33:51.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="启用Mac自带的php"><a href="#启用Mac自带的php" class="headerlink" title="启用Mac自带的php"></a>启用Mac自带的php</h2><p>PHP的启动只需要在Apache服务中进行一下配置即可直接使用</p>
<p>首先,在/private/etc/apache2目录下找到并打开httpd.conf文件</p>
<p>其次,搜索#LoadModule php5_module libexec/apache2/libphp5.so,将前方的#删除</p>
<p>再次,重启Apache服务即可</p>
<p>最后,WebServer路径下新建一个info.php测试程序试试效果吧</p>
<p>&lt;?php<br>phpinfo();<br>?&gt;<br>在浏览器中输入如下网址即可查看到PHP的信息</p>
<p><a href="http://localhost/info.php" target="_blank" rel="external">http://localhost/info.php</a></p>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h3><p>首先,在浏览器中输入如下网址,下载图中所示文件并安装</p>
<p><a href="http://dev.mysql.com/downloads/mysql/" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/</a></p>
<p><img src="http://img.blog.csdn.net/20160924161706718" alt=""></p>
<p>其次,在终端中输入如下命令,查看MySQL版本</p>
<p>mysql –version<br>在本机中版本信息如下</p>
<p>mysql  Ver 14.14 Distrib 5.7.14, for osx10.11 (x86_64) using  EditLine wrapper<br>如果提示command not found,这是因为该命令默认访问/usr/local/bin/mysql路径下的mysql,所以我们可以在终端输入如下命令,建立一个软链接即可</p>
<p>sudo ln -fs /usr/local/mysql/bin/mysql /usr/local/bin/mysql<br>再次,利用安装MySQL时给出的用户和密码登录MySQL服务,在终端中输入如下命令,敲击回车后输入密码</p>
<p>mysql -u root -p</p>
<p>进入后显示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Password:</div><div class="line">Enter password:</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 15</div><div class="line">Server version: 5.7.19</div><div class="line"></div><div class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</div></pre></td></tr></table></figure>
<p>然后再输入一下命令修改密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SET PASSWORD = PASSWORD(&apos;xxxxxxxx&apos;);</div></pre></td></tr></table></figure>
<p>然后在终端中输入如下命令,退出MySQL服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exit</div></pre></td></tr></table></figure>
<h3 id="MySQL的启动与停止"><a href="#MySQL的启动与停止" class="headerlink" title="MySQL的启动与停止"></a>MySQL的启动与停止</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo /usr/local/mysql/support-files/mysql.server start</div><div class="line">sudo /usr/local/mysql/support-files/mysql.server stop</div></pre></td></tr></table></figure>
<h2 id="MySQL可视化管理方式phpMyAdmin"><a href="#MySQL可视化管理方式phpMyAdmin" class="headerlink" title="MySQL可视化管理方式phpMyAdmin"></a>MySQL可视化管理方式phpMyAdmin</h2><p>首先,在浏览器中输入如下网址,下载图中所示文件</p>
<p><a href="https://www.phpmyadmin.net/downloads/" target="_blank" rel="external">https://www.phpmyadmin.net/downloads/</a></p>
<p>次,将压缩文件解压到/资源库/WebServer/Documents/路径下,并重命名为phpMyAdmin</p>
<p>再次,将文件夹中的config.sample.inc.php文件重命名为config.inc.php</p>
<p>再次,将config.inc.php文件中的如下代码进行修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 修改前:</div><div class="line">$cfg[&apos;Servers&apos;][$i][&apos;host&apos;] = &apos;localhost&apos;;</div><div class="line"></div><div class="line">// 修改后:</div><div class="line">$cfg[&apos;Servers&apos;][$i][&apos;host&apos;] = &apos;127.0.0.1&apos;;</div></pre></td></tr></table></figure>
<p>最后,在浏览器中输入如下网址进行登录即可直接对MySQL进行可视化管理</p>
<p><a href="http://localhost/phpmyadmin/" target="_blank" rel="external">http://localhost/phpmyadmin/</a></p>
<p><code>注: 默认用户名为root</code></p>
<p>摘录自<a href="http://www.cnblogs.com/henusyj-1314/p/6485182.html" target="_blank" rel="external">http://www.cnblogs.com/henusyj-1314/p/6485182.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;启用Mac自带的php&quot;&gt;&lt;a href=&quot;#启用Mac自带的php&quot; class=&quot;headerlink&quot; title=&quot;启用Mac自带的php&quot;&gt;&lt;/a&gt;启用Mac自带的php&lt;/h2&gt;&lt;p&gt;PHP的启动只需要在Apache服务中进行一下配置即可直接使用&lt;/p
    
    </summary>
    
    
      <category term="PHP" scheme="https://devchao.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Runtime</title>
    <link href="https://devchao.com/2017/08/25/Runtime/"/>
    <id>https://devchao.com/2017/08/25/Runtime/</id>
    <published>2017-08-25T10:03:27.000Z</published>
    <updated>2017-08-28T01:47:57.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Runtime-学习"><a href="#Runtime-学习" class="headerlink" title="Runtime 学习"></a>Runtime 学习</h2><p>前言：</p>
<p>Objc是一门动态语言，所以它总是想办法把一些决定工作从编译连接推迟到运行时。也就是说只有编译器是不够的，还需要一个运行时系统 (runtime system) 来执行编译后的代码.</p>
<h2 id="铺垫："><a href="#铺垫：" class="headerlink" title="铺垫："></a><code>铺垫：</code></h2><h3 id="1-objc-msgSend"><a href="#1-objc-msgSend" class="headerlink" title="1. objc_msgSend"></a>1. objc_msgSend</h3><p>首先需要引入 <code>&lt;objc/message.h&gt; &lt;objc/runtime.h&gt;</code>头文件。</p>
<p> 我们通常的方法调用：[receiver message]，实际上是被编译器转化为了 objc_msgSend(receiver, selector)，下面来证明：</p>
<p><strong>新建一个Person类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#import &quot;Person.h&quot;</div><div class="line"></div><div class="line">@implementation Person</div><div class="line"></div><div class="line">-(instancetype)init</div><div class="line">&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        [self say];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)say&#123;</div><div class="line">    NSLog(@&quot;Zhang Yachao&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><strong>使用 clang 重写命令</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ clang -rewrite-objc MyClass.m</div></pre></td></tr></table></figure>
<p>然后在同一目录下会多出一个 MyClass.cpp 文件，双击打开，可以看到 init 方法已经被编译器转化为下面这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">static instancetype _I_Person_init(Person * self, SEL _cmd) &#123;</div><div class="line">    if (self = ((Person *(*)(__rw_objc_super *, SEL))(void *)objc_msgSendSuper)((__rw_objc_super)&#123;(id)self, (id)class_getSuperclass(objc_getClass(&quot;Person&quot;))&#125;, sel_registerName(&quot;init&quot;))) &#123;</div><div class="line">        ((void (*)(id, SEL))(void *)objc_msgSend)((id)self, sel_registerName(&quot;say&quot;));</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们要找的就是它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">((void (*)(id, SEL))(void *)objc_msgSend)((id)self, sel_registerName(&quot;say&quot;));</div></pre></td></tr></table></figure>
<p>objc_msgSend 函数被定义在 objc/message.h 目录下，其函数原型是酱紫滴：<br>附：<a href="https://opensource.apple.com/source/objc4/" target="_blank" rel="external">Runtime 开源Code</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OBJC_EXPORT void objc_msgSend(void /* id self, SEL op, ... */ )</div></pre></td></tr></table></figure>
<h3 id="2-SEL"><a href="#2-SEL" class="headerlink" title="2.SEL"></a>2.SEL</h3><p>SEL 被定义在 objc/objc.h 目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">typedef struct objc_selector *SEL;</div></pre></td></tr></table></figure>
<p>其实它就是个映射到方法的C字符串，你可以用 Objective-C 编译器命令 @selector() 或者 Runtime 系统的 sel_registerName 函数来获得一个 SEL 类型的方法选择器。</p>
<h3 id="3-id"><a href="#3-id" class="headerlink" title="3.id"></a>3.id</h3><p>id 也被定义在 objc/objc.h 目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">typedef struct objc_object *id;</div></pre></td></tr></table></figure>
<p>id 是一个结构体指针类型，它可以指向 Objective-C 中的任何对象。objc_object 结构体定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">struct objc_object &#123; Class isa OBJC_ISA_AVAILABILITY;&#125;;</div></pre></td></tr></table></figure>
<p>我们通常所说的对象，就长这个样子，这个结构体只有一个成员变量 isa，对象可以通过 isa 指针找到其所属的类。isa 是一个 Class 类型的成员变量，那么 Class 又是什么呢？</p>
<h3 id="4-Class"><a href="#4-Class" class="headerlink" title="4.Class"></a>4.Class</h3><p>Class 也是一个结构体指针类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">typedef struct objc_class *Class;</div></pre></td></tr></table></figure>
<p>objc_class 结构体是酱紫滴：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">struct objc_class &#123;</div><div class="line">    Class isa  OBJC_ISA_AVAILABILITY;</div><div class="line">#if !__OBJC2__</div><div class="line">    Class super_class   OBJC2_UNAVAILABLE;</div><div class="line">    const char *name   OBJC2_UNAVAILABLE;</div><div class="line">    long version     OBJC2_UNAVAILABLE;</div><div class="line">    long info     OBJC2_UNAVAILABLE;</div><div class="line">    long instance_size   OBJC2_UNAVAILABLE;</div><div class="line">    struct objc_ivar_list *ivars  OBJC2_UNAVAILABLE;</div><div class="line">    struct objc_method_list **methodLists  OBJC2_UNAVAILABLE;</div><div class="line">    struct objc_cache *cache    OBJC2_UNAVAILABLE;</div><div class="line">    struct objc_protocol_list *protocols   OBJC2_UNAVAILABLE;</div><div class="line">#endif</div><div class="line">&#125; OBJC2_UNAVAILABLE;</div></pre></td></tr></table></figure>
<ul>
<li>Class 也有一个 isa 指针，指向其所属的元类（meta）。</li>
<li>super_class：指向其超类。</li>
<li>name：是类名</li>
<li>version：是类的版本信息</li>
<li>info：是类的详情。</li>
<li>instance_size：是该类的实例对象的大小。</li>
<li>ivars：指向该类的成员变量列表。</li>
<li>methodLists：指向该类的实例方法列表，它将方法选择器和方法实现地址联系起来。methodLists 是指向 ·objc_method_list 指针的指针，也就是说可以动态修改 *methodLists 的值来添加成员方法，这也是 Category 实现的原理，同样解释了 Category 不能添加属性的原因。</li>
<li>cache：Runtime 系统会把被调用的方法存到 cache 中（理论上讲一个方法如果被调用，那么它有可能今后还会被调用），下次查找的时候效率更高。</li>
<li>protocols：指向该类的协议列表。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">struct objc_class : objc_object &#123;</div><div class="line">    // Class ISA;</div><div class="line">    Class superclass;</div><div class="line">    cache_t cache;             // formerly cache pointer and vtable</div><div class="line">    class_data_bits_t bits;    // class_rw_t * plus custom rr/alloc flags</div><div class="line">    class_rw_t *data() &#123; </div><div class="line">        return bits.data();</div><div class="line">    &#125;</div><div class="line">    ... 省略其他方法</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然而objc_class 继承自 objc_object，也就是说Class其实也是一种对象又名类对象，为了处理类和对象的关系，runtime 库创建了一种叫做元类 (Meta Class) 的东西，类对象所属类型就叫做元类，它用来表述类对象本身所具备的元数据。类方法就定义于此处，因为这些方法可以理解成类对象的实例方法。每个类仅有一个类对象，而每个类对象仅有一个与之相关的元类。当你发出一个类似 [NSObject alloc] 的消息时，你事实上是把这个消息发给了一个类对象 (Class Object) ，这个类对象必须是一个元类的实例，而这个元类同时也是一个根元类 (root meta class) 的实例。所有的元类最终都指向根元类为其超类。所有的元类的方法列表都有能够响应消息的类方法。所以当 [NSObject alloc] 这条消息发给类对象的时候，objc_msgSend() 会去它的元类里面去查找能够响应消息的方法，如果找到了，然后对这个类对象执行方法调用。也就是说类方法被存储在元类中，Class 通过 isa 指针即可找到其所属的元类然后发送消息。</p>
<p><img src="https://ws1.sinaimg.cn/large/00663vn1ly1fiw200otvzj30px0r541d.jpg" alt=""><br>上图实线是 superclass 指针，虚线是isa指针。 有趣的是根元类的超类是 NSObject，而 isa 指向了自己，而 NSObject 的超类为 nil，也就是它没有超类。</p>
<p>可以看到运行时一个类还关联了它的超类指针，类名，成员变量，方法，缓存，还有附属的协议。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a><code>使用</code></h2><h3 id="1-使用objc-msgSend向对象发送消息"><a href="#1-使用objc-msgSend向对象发送消息" class="headerlink" title="1.使用objc_msgSend向对象发送消息"></a>1.使用objc_msgSend向对象发送消息</h3><p>新建一个类TestClass,添加如下方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (void)showAge&#123;</div><div class="line">    NSLog(@&quot;I&apos;m 27 years.&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)showName&#123;</div><div class="line">    NSLog(@&quot;My name is Zhang Yachao.&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)showSizeWithWidth:(float)width Height:(float)height&#123;</div><div class="line">    NSLog(@&quot;size is width: %.2f, height: %.2f&quot;,width,height);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (float)getHeight&#123;</div><div class="line">    return 177.5f;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (NSString *)getInfo&#123;</div><div class="line">    return @&quot;Hi, my name is Zhang Yachao, I&apos;m twenty-seven years old in the year, I like apple, nice to meet you.&quot;;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们可以像下面这样，使用 objc_msgSend 依次调用这些方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">TestClass *object = [[TestClass alloc]init];</div><div class="line">    </div><div class="line">//调用showAge方法</div><div class="line">((void (*)(id,SEL))objc_msgSend) (object,sel_registerName(&quot;showAge&quot;));</div><div class="line">//调用showName方法</div><div class="line">((void (*) (id, SEL))objc_msgSend) (object,sel_registerName(&quot;showName&quot;));</div><div class="line">//调用showSizeWithWidth:Height:方法</div><div class="line">((void (*)(id, SEL, float, float))objc_msgSend) (object,sel_registerName(&quot;showSizeWithWidth:Height:&quot;),12.5f,13.6f);</div><div class="line">//调用getHeight方法</div><div class="line">float height = ((float (*)(id,SEL))objc_msgSend) (object,sel_registerName(&quot;getHeight&quot;));</div><div class="line">NSLog(@&quot;height = %.1f&quot;,height);</div><div class="line">//调用getInfo方法</div><div class="line">NSString *info = ((NSString * (*)(id,SEL)) objc_msgSend) (object,sel_registerName(&quot;getInfo&quot;));</div><div class="line">NSLog(@&quot;%@&quot;,info);</div></pre></td></tr></table></figure>
<p>也许你已经注意到，objc_msgSend 在使用时都被强制转换了一下，这是因为 objc_msgSend 函数可以hold住各种不同的返回值以及多个参数，但默认情况下是没有参数和返回值的。如果我们把调用 showAge 方法改成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">objc_msgSend(objct, sel_registerName(&quot;showAge&quot;));</div></pre></td></tr></table></figure>
<p>Xcode 就会报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Too many arguments to function call, expected 0, have 2.</div></pre></td></tr></table></figure>
<p>注意 ：<code>objc_msgSend从不返回数据而是你的方法被调用后返回了数据。</code></p>
<p>下面详细叙述下消息发送步骤：</p>
<ul>
<li>1.检测这个 selector 是不是要忽略的。比如 Mac OS X 开发，有了垃圾回收就不理会 retain, release 这些函数了。</li>
<li>2.检测这个 target 是不是 nil 对象。ObjC 的特性是允许对一个 nil 对象执行任何一个方法不会 Crash，因为会被忽略掉。</li>
<li>3.如果上面两个都过了，那就开始查找这个类的 IMP，先从 cache 里面找，完了找得到就跳到对应的函数去执行。</li>
<li>4.如果 cache 找不到就找一下Class中的方法列表。</li>
<li>5.如果Class中的方法列表找不到就到超类的方法列表去找，一直找，直到找到NSObject类为止</li>
<li>6.如果还找不到就要开始进入动态方法解析了，后面会提到。</li>
</ul>
<p>其实编译器会根据情况在objc_msgSend, objc_msgSend_stret, objc_msgSendSuper, 或 objc_msgSendSuper_stret四个方法中选择一个来调用。如果消息是传递给超类，那么会调用名字带有”Super”的函数；如果消息返回值是数据结构而不是简单值时，那么会调用名字带有”stret”的函数。排列组合正好四个方法。<br>值得一提的是在 i386 平台处理返回类型为浮点数的消息时，需要用到objc_msgSend_fpret函数来进行处理，这是因为返回类型为浮点数的函数对应的 ABI(Application Binary Interface) 与返回整型的函数的 ABI 不兼容。此时objc_msgSend不再适用，于是objc_msgSend_fpret被派上用场，它会对浮点数寄存器做特殊处理。不过在 PPC 或 PPC64 平台是不需要麻烦它的。</p>
<p>PS：有木有发现这些函数的命名规律哦？带“Super”的是消息传递给超类；“stret”可分为“st”+“ret”两部分，分别代表“struct”和“return”；“fpret”就是“fp”+“ret”，分别代表“floating-point”和“return”。</p>
<h4 id="下面详细说下objc-msgSendSuper"><a href="#下面详细说下objc-msgSendSuper" class="headerlink" title="下面详细说下objc_msgSendSuper"></a>下面详细说下<code>objc_msgSendSuper</code></h4><p><code>objc_msgSendSuper</code>函数原型如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OBJC_EXPORT void objc_msgSendSuper(void /* struct objc_super *super, SEL op, ... */ )</div></pre></td></tr></table></figure>
<p>当我们调用 [super selector] 时，Runtime 会调用 objc_msgSendSuper 方法，objc_msgSendSuper 方法有两个参数，super 和 op，Runtime 会把 selector 方法选择器赋值给 op。而 super 是一个 objc_super 结构体指针，objc_super 结构体定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">struct objc_super &#123;</div><div class="line">    /// Specifies an instance of a class.</div><div class="line">    __unsafe_unretained id receiver;</div><div class="line">    /// Specifies the particular superclass of the instance to message.</div><div class="line">#if !defined(__cplusplus)  &amp;&amp;  !__OBJC2__</div><div class="line">    /* For compatibility with old objc-runtime.h header */</div><div class="line">    __unsafe_unretained Class class;</div><div class="line">#else</div><div class="line">    __unsafe_unretained Class super_class;</div><div class="line">#endif</div><div class="line">    /* super_class is the first class to search */</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Runtime 会创建一个 objc_spuer 结构体变量，将其地址作为参数（super）传递给 objc_msgSendSuper，并且将 self 赋值给 receiver：super—&gt;receiver=self。</p>
<p>举个栗子，问下面的代码输出什么：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@implementation Son : Father</div><div class="line">- (id)init</div><div class="line">&#123;</div><div class="line">    self = [super init];</div><div class="line">    if (self)</div><div class="line">    &#123;</div><div class="line">        NSLog(@&quot;%@&quot;, NSStringFromClass([self class]));</div><div class="line">        NSLog(@&quot;%@&quot;, NSStringFromClass([super class]));</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>答案是全部输出 Son。</p>
<p>使用 clang 重写命令，发现上述代码被转化为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSLog((NSString *)&amp;__NSConstantStringImpl__var_folders_gm_0jk35cwn1d3326x0061qym280000gn_T_main_a5cecc_mi_0, NSStringFromClass(((Class (*)(id, SEL))(void *)objc_msgSend)((id)self, sel_registerName(&quot;class&quot;))));</div><div class="line">NSLog((NSString *)&amp;__NSConstantStringImpl__var_folders_gm_0jk35cwn1d3326x0061qym280000gn_T_main_a5cecc_mi_1, NSStringFromClass(((Class (*)(__rw_objc_super *, SEL))(void *)objc_msgSendSuper)((__rw_objc_super)&#123; (id)self, (id)class_getSuperclass(objc_getClass(&quot;Son&quot;)) &#125;, sel_registerName(&quot;class&quot;))));</div></pre></td></tr></table></figure>
<p>当调用 [super class] 时，会转换成 objc_msgSendSuper 函数：</p>
<ul>
<li>第一步先构造 objc_super 结构体，结构体第一个成员就是 self。第二个成员是 (id)class_getSuperclass(objc_getClass(“Son”)).</li>
<li>第二步是去 Father 这个类里去找 - (Class)class，没有，然后去 NSObject 类去找，找到了。最后内部是使用 objc_msgSend(objc_super-&gt;receiver, @selector(class)) 去调用，此时已经和 [self class] 调用相同了，所以两个输出结果都是 Son。</li>
</ul>
<h3 id="2-对象关联"><a href="#2-对象关联" class="headerlink" title="2.对象关联"></a>2.对象关联</h3><p>对象关联允许开发者对已经存在的类在 Category 中添加自定义的属性：</p>
<h4 id="1-添加对象"><a href="#1-添加对象" class="headerlink" title="1.添加对象"></a>1.添加对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OBJC_EXPORT void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_1);</div></pre></td></tr></table></figure>
<ul>
<li>object 是源对象</li>
<li>key 是关联的键，objc_getAssociatedObject 方法通过不同的 key 即可取出对应的被关联对象</li>
<li><p>policy 是一个枚举值，表示关联对象的行为，从命名就能看出各个枚举值的含义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123;</div><div class="line">    OBJC_ASSOCIATION_ASSIGN = 0,           /**&lt; Specifies a weak reference to the associated object. */</div><div class="line">    OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1, /**&lt; Specifies a strong reference to the associated object.</div><div class="line">                                            *   The association is not made atomically. */</div><div class="line">    OBJC_ASSOCIATION_COPY_NONATOMIC = 3,   /**&lt; Specifies that the associated object is copied.</div><div class="line">                                            *   The association is not made atomically. */</div><div class="line">    OBJC_ASSOCIATION_RETAIN = 01401,       /**&lt; Specifies a strong reference to the associated object.</div><div class="line">                                            *   The association is made atomically. */</div><div class="line">    OBJC_ASSOCIATION_COPY = 01403          /**&lt; Specifies that the associated object is copied.</div><div class="line">                                            *   The association is made atomically. */</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-删除对象"><a href="#2-删除对象" class="headerlink" title="2.删除对象"></a>2.删除对象</h4><p>要取出被关联的对象使用 objc_getAssociatedObject 方法即可，要删除一个被关联的对象，使用 objc_setAssociatedObject 方法将key对应的对象设置成 nil 即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">objc_setAssociatedObject(self, associatedKey, nil, OBJC_ASSOCIATION_COPY_NONATOMIC);</div></pre></td></tr></table></figure>
<p>objc_removeAssociatedObjects 方法将会移除源对象中所有的关联对象.</p>
<p>举个栗子，假如我们要给 UIButton 添加一个监听单击事件的 block 属性，新建 UIButton 的 Category，其.m文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#import &quot;UIButton+ClickBlock.h&quot;</div><div class="line">#import static const void *associatedKey = &quot;associatedKey&quot;;</div><div class="line">@implementation UIButton (ClickBlock)</div><div class="line">//Category中的属性，只会生成setter和getter方法，不会生成成员变量</div><div class="line">-(void)setClick:(clickBlock)click&#123;</div><div class="line">    objc_setAssociatedObject(self, associatedKey, click, OBJC_ASSOCIATION_COPY_NONATOMIC);</div><div class="line">    [self removeTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    if (click) &#123;</div><div class="line">        [self addTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">-(clickBlock)click&#123;</div><div class="line">    return objc_getAssociatedObject(self, associatedKey);</div><div class="line">&#125;</div><div class="line">-(void)buttonClick&#123;</div><div class="line">    if (self.click) &#123;</div><div class="line">        self.click();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>然后在代码中，就可以使用 UIButton 的属性来监听单击事件了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];</div><div class="line">button.frame = self.view.bounds;</div><div class="line">[self.view addSubview:button];</div><div class="line">button.click = ^&#123;</div><div class="line">    NSLog(@&quot;buttonClicked&quot;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="3-自动归档"><a href="#3-自动归档" class="headerlink" title="3.自动归档"></a>3.自动归档</h3><p>在学习 Runtime 之前，归档的时候是酱紫写的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (void)encodeWithCoder:(NSCoder *)aCoder&#123;</div><div class="line">    [aCoder encodeObject:self.name forKey:@&quot;name&quot;];</div><div class="line">    [aCoder encodeObject:self.ID forKey:@&quot;ID&quot;];</div><div class="line">&#125;</div><div class="line">- (id)initWithCoder:(NSCoder *)aDecoder&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        self.ID = [aDecoder decodeObjectForKey:@&quot;ID&quot;];</div><div class="line">        self.name = [aDecoder decodeObjectForKey:@&quot;name&quot;];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那么问题来了，如果当前 Model 有100个属性的话，就需要写100行这种代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[aCoder encodeObject:self.name forKey:@&quot;name&quot;];</div></pre></td></tr></table></figure>
<p>想象都头疼，通过 Runtime 我们就可以轻松解决这个问题：</p>
<ul>
<li>1.使用 class_copyIvarList 方法获取当前 Model 的所有成员变量.</li>
<li>2.使用 ivar_getName 方法获取成员变量的名称.</li>
<li>3.通过 KVC（或者使用object_getIvar()） 来读取 Model 的属性(变量)值（encodeWithCoder:），以及给 Model 的属性赋值（initWithCoder:）.</li>
</ul>
<p>举个栗子，新建一个 Model 类，其.m文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">#import &quot;TestModel.h&quot;</div><div class="line">#import #import @implementation TestModel</div><div class="line">- (void)encodeWithCoder:(NSCoder *)aCoder&#123;</div><div class="line">    unsigned int outCount = 0;</div><div class="line">    Ivar *vars = class_copyIvarList([self class], &amp;outCount);</div><div class="line">    for (int i = 0; i &lt; outCount; i ++) &#123;</div><div class="line">        Ivar var = vars[i];</div><div class="line">        const char *name = ivar_getName(var);</div><div class="line">        NSString *key = [NSString stringWithUTF8String:name];</div><div class="line">        // 注意kvc的特性是，如果能找到key这个属性的setter方法，则调用setter方法</div><div class="line">        // 如果找不到setter方法，则查找成员变量key或者成员变量_key，并且为其赋值</div><div class="line">        // 所以这里不需要再另外处理成员变量名称的“_”前缀</div><div class="line">        id value = [self valueForKey:key];</div><div class="line">        [aCoder encodeObject:value forKey:key];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        unsigned int outCount = 0;</div><div class="line">        Ivar *vars = class_copyIvarList([self class], &amp;outCount);</div><div class="line">        for (int i = 0; i &lt; outCount; i ++) &#123;</div><div class="line">            Ivar var = vars[i];</div><div class="line">            const char *name = ivar_getName(var);</div><div class="line">            NSString *key = [NSString stringWithUTF8String:name];</div><div class="line">            id value = [aDecoder decodeObjectForKey:key];</div><div class="line">            [self setValue:value forKey:key];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<h3 id="4-字典与模型互转"><a href="#4-字典与模型互转" class="headerlink" title="4.字典与模型互转"></a>4.字典与模型互转</h3><p>最开始是这样用字典给 Model 赋值的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-(instancetype)initWithDictionary:(NSDictionary *)dict&#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line">        self.age = dict[@&quot;age&quot;];</div><div class="line">        self.name = dict[@&quot;name&quot;];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可想而知，遇到的问题跟归档时候一样这里我们稍微来学习一下其中原理，字典转模型的时候：</p>
<ul>
<li>根据字典的 key 生成 setter 方法</li>
<li>使用 objc_msgSend 调用 setter 方法为 Model 的属性赋值（或者 KVC）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line">+ (id)objectWithKeyValues:(NSDictionary *)aDictinary&#123;</div><div class="line">    id objc = [[self alloc] init];</div><div class="line">    for (NSString *key in aDictinary.allKeys) &#123;</div><div class="line">        id value = aDictinary[key];</div><div class="line">        </div><div class="line">        /*判断当前属性是不是Model*/</div><div class="line">        objc_property_t property = class_getProperty(self, key.UTF8String);</div><div class="line">        unsigned int outCount = 0;</div><div class="line">        objc_property_attribute_t * attributeList = property_copyAttributeList(property, &amp;outCount);</div><div class="line">        //T : @&quot;Number&quot;   &amp; : retain   N : @&quot;&quot;   v : _age 详见下图</div><div class="line">        objc_property_attribute_t attribute = attributeList[0];</div><div class="line">        NSString *typeString = [NSString stringWithUTF8String:attribute.value];</div><div class="line">        </div><div class="line">        //@&quot;NSNumber&quot;</div><div class="line">        if ([typeString isEqualToString:@&quot;@\&quot;TestModel\&quot;&quot;]) &#123;</div><div class="line">           value = [self objectWithKeyValues:value];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        /**********************/</div><div class="line">        //生成setter方法，并用objc_msgSend调用</div><div class="line">        NSString *methodName = [NSString stringWithFormat:@&quot;set%@%@:&quot;,[key substringToIndex:1].uppercaseString,[key substringFromIndex:1]];</div><div class="line">        SEL setter = sel_registerName(methodName.UTF8String);</div><div class="line">        if ([objc respondsToSelector:setter]) &#123;</div><div class="line">            ((void (*) (id,SEL,id))objc_msgSend) (objc,setter,value);</div><div class="line">        &#125;</div><div class="line">        free(attributeList);</div><div class="line">    &#125;</div><div class="line">    return objc;&#125;</div><div class="line">    </div><div class="line">- (NSDictionary *)keyValuesWithObject&#123;</div><div class="line">    unsigned int outCount = 0;</div><div class="line">   objc_property_t *protertyList = class_copyPropertyList([self class], &amp;outCount);</div><div class="line">    NSMutableDictionary *dict = [NSMutableDictionary dictionary];</div><div class="line">    for (NSUInteger i = 0; i &lt; outCount; i++) &#123;</div><div class="line">        objc_property_t property = protertyList[i];</div><div class="line">        const char *propertyName = property_getName(property);</div><div class="line">        SEL getter = sel_registerName(propertyName);</div><div class="line">        if ([self respondsToSelector:getter]) &#123;</div><div class="line">            id value = ((id (*) (id,SEL))objc_msgSend) (self,getter);</div><div class="line">            //判断当前属性是不是Model</div><div class="line">            if ([value isKindOfClass:[self class]] &amp;&amp; value) &#123;</div><div class="line">                value = [value keyValuesWithObject];</div><div class="line">            &#125;</div><div class="line">            if (value) &#123;</div><div class="line">                NSString *key = [NSString stringWithUTF8String:propertyName];</div><div class="line">                [dict setObject:value forKey:key];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    free(protertyList);</div><div class="line">    return dict;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://ws1.sinaimg.cn/large/00663vn1ly1fiz72royfjj31eq0vqdma.jpg" alt=""></p>
<h4 id="5-动态方法解析"><a href="#5-动态方法解析" class="headerlink" title="5.动态方法解析"></a>5.动态方法解析</h4><p>前面我们留下了一点东西没说，那就是如果某个对象调用了不存在的方法时会怎么样，一般情况下程序会crash，错误信息类似下面这样：</p>
<p>unrecognized selector sent to instance 0x7fd0a141afd0</p>
<p>但是在程序crash之前，Runtime 会给我们动态方法解析的机会:<br><img src="https://ws1.sinaimg.cn/large/00663vn1ly1fiw4enl7u6j30m80h6q4q.jpg" alt=""></p>
<ul>
<li>1.进入 resolveInstanceMethod: 方法，指定是否动态添加方法。若返回NO，则进入下一步，若返回YES，则通过 class_addMethod 函数动态地添加方法，消息得到处理，此流程完毕。</li>
<li>2.resolveInstanceMethod: 方法返回 NO 时，就会进入 forwardingTargetForSelector: 方法，这是 Runtime 给我们的第二次机会，用于指定哪个对象响应这个 selector。返回nil，进入下一步，返回某个对象，则会调用该对象的方法。</li>
<li>3.若 forwardingTargetForSelector: 返回的是nil，则我们首先要通过 methodSignatureForSelector: 来指定方法签名，返回nil，表示不处理，若返回方法签名，则会进入下一步。</li>
<li><p>4.当第 methodSignatureForSelector: 方法返回方法签名后，就会调用 forwardInvocation: 方法，我们可以通过 anInvocation 对象做很多处理，比如修改实现方法，修改响应对象等。</p>
<p>如果到最后，消息还是没有得到响应，程序就会crash</p>
</li>
</ul>
<h3 id="6-获取方法的指针-IMP-直接调用，不使用消息发送机制"><a href="#6-获取方法的指针-IMP-直接调用，不使用消息发送机制" class="headerlink" title="6.获取方法的指针 IMP 直接调用，不使用消息发送机制"></a>6.获取方法的指针 IMP 直接调用，不使用消息发送机制</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> void (*logFunc) (id,SEL,id);</div><div class="line">    </div><div class="line">IMP method = [self methodForSelector:@selector(logName:)];</div><div class="line">logFunc = (void (*)(id,SEL,id))method;</div><div class="line">    </div><div class="line">logFunc(self,@selector(logName:),@&quot;yachao&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(void)logName:(NSString *)name</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;%@&quot;,name);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>参考</code></p>
<p><a href="https://github.com/daiweiping/RuntimeLearn" target="_blank" rel="external">相关代码</a></p>
<p><a href="http://yulingtianxia.com/blog/2014/11/05/objective-c-runtime/" target="_blank" rel="external">Objective-C Runtime</a></p>
<p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html#//apple_ref/doc/uid/TP40008048-CH101-SW24" target="_blank" rel="external">官方文档</a></p>
<p># </p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Runtime-学习&quot;&gt;&lt;a href=&quot;#Runtime-学习&quot; class=&quot;headerlink&quot; title=&quot;Runtime 学习&quot;&gt;&lt;/a&gt;Runtime 学习&lt;/h2&gt;&lt;p&gt;前言：&lt;/p&gt;
&lt;p&gt;Objc是一门动态语言，所以它总是想办法把一些决定工作
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>UIImagePickerController旋转问题</title>
    <link href="https://devchao.com/2017/08/09/UIImagePickerController%E6%97%8B%E8%BD%AC%E9%97%AE%E9%A2%98/"/>
    <id>https://devchao.com/2017/08/09/UIImagePickerController旋转问题/</id>
    <published>2017-08-09T09:05:46.000Z</published>
    <updated>2017-08-09T09:06:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>UIImagePickerController旋转问题</p>
<p>问题：通过UIImagePickerController获取系统相册时，控制器方向只支持竖屏，不支持横屏的问题</p>
<p>解决方案：</p>
<p>1.app delegate中<code>-(UIInterfaceOrientationMask)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window</code>返回<code>UIInterfaceOrientationMaskAll</code>,以支持所有方向</p>
<p>2.info.plist中添加如下键值对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;UISupportedInterfaceOrientations~ipad&lt;/key&gt;</div><div class="line">	&lt;array&gt;</div><div class="line">		&lt;string&gt;UIInterfaceOrientationPortrait&lt;/string&gt;</div><div class="line">		&lt;string&gt;UIInterfaceOrientationPortraitUpsideDown&lt;/string&gt;</div><div class="line">		&lt;string&gt;UIInterfaceOrientationLandscapeLeft&lt;/string&gt;</div><div class="line">		&lt;string&gt;UIInterfaceOrientationLandscapeRight&lt;/string&gt;</div><div class="line">	&lt;/array&gt;</div></pre></td></tr></table></figure>
<p>2.创建一个UIImagePickerController的类别,并重写<code>-(UIInterfaceOrientationMask)supportedInterfaceOrientations</code>方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(UIInterfaceOrientationMask)supportedInterfaceOrientations</div><div class="line">&#123;</div><div class="line">    return UIInterfaceOrientationMaskAll;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>总结：<br>每次调用一个视图控制器的时候，都会调用指定支持屏幕的方法 - (UIInterfaceOrientationMask)application:(UIApplication <em>)application supportedInterfaceOrientationsForWindow:(UIWindow </em>)window                                       同时在一个视图控制器显示的时候，会调用自己的 支持屏幕方向 supportedInterfaceOrientations 的方法，所以才能在 UIImagePickerController 显示的时候通过指定支持方向来改变 其在用户面前展现的方向</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;UIImagePickerController旋转问题&lt;/p&gt;
&lt;p&gt;问题：通过UIImagePickerController获取系统相册时，控制器方向只支持竖屏，不支持横屏的问题&lt;/p&gt;
&lt;p&gt;解决方案：&lt;/p&gt;
&lt;p&gt;1.app delegate中&lt;code&gt;-(UII
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>iOS调节显示器参数之将屏幕亮度降低至系统亮度以下</title>
    <link href="https://devchao.com/2017/07/20/iOS%E8%B0%83%E8%8A%82%E6%98%BE%E7%A4%BA%E5%99%A8%E5%8F%82%E6%95%B0%E4%B9%8B%E5%B0%86%E5%B1%8F%E5%B9%95%E4%BA%AE%E5%BA%A6%E9%99%8D%E4%BD%8E%E8%87%B3%E7%B3%BB%E7%BB%9F%E4%BA%AE%E5%BA%A6%E4%BB%A5%E4%B8%8B/"/>
    <id>https://devchao.com/2017/07/20/iOS调节显示器参数之将屏幕亮度降低至系统亮度以下/</id>
    <published>2017-07-20T06:46:40.000Z</published>
    <updated>2017-07-20T07:13:34.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/anthonya1999/GoodNight" target="_blank" rel="external">GoodNight</a>:使用IOMobileFramebuffer调节显示器参数的App.能够实现以下功能：</p>
<ul>
<li>更改屏幕温度</li>
<li>把亮度低于iOS通常会允许你的最低亮度</li>
<li>调整帧缓冲区的RGB值</li>
</ul>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>1.下载GoodNight库，将Shared下文件添加入项目，具体如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">IOMobileFramebufferClient.h</div><div class="line">IOMobileFramebufferClient.m</div><div class="line">MobileGestaltClient.h</div><div class="line">MobileGestaltClient.m</div><div class="line">SpringBoardServicesClient.h</div><div class="line">SpringBoardServicesClient.m</div><div class="line">GammaController.h</div><div class="line">GammaController.m</div><div class="line">Brightness.h</div><div class="line">Brightness.c</div><div class="line">NSDate+Extensions.h</div><div class="line">NSDate+Extensions.m</div><div class="line">Solar.h</div><div class="line">Solar.m</div></pre></td></tr></table></figure>
<p>2.打开TARGETS&gt;Capabilities&gt;APPGroup，添加一个App groups,并选中打勾。<br><img src="https://ws1.sinaimg.cn/large/00663vn1ly1fhqbyforvyj314s0c4aba.jpg" alt=""></p>
<p>3.将下列代码添加至pch文件中, appGroupID 改成自己的app group ID.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#define appGroupID @&quot;your group id&quot;</div><div class="line">#define userDefaults [NSUserDefaults standardUserDefaults]</div><div class="line">#define groupDefaults [[NSUserDefaults alloc] initWithSuiteName:appGroupID]</div><div class="line">#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v)  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)</div><div class="line">#define SYSTEM_VERSION_LESS_THAN(v)                 ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedAscending)</div><div class="line">#define app [UIApplication sharedApplication]</div></pre></td></tr></table></figure>
<p>4.在GammaController.h中添加如下头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#pragma mark - custome</div><div class="line">+ (void)setDimWithRed:(float)redDim green:(float)greenDim blue:(float)blueDim;</div></pre></td></tr></table></figure>
<p>5.在GammaController.m中添加如下实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#pragma mark - custome</div><div class="line">+ (void)setDimWithRed:(float)redDim green:(float)greenDim blue:(float)blueDim</div><div class="line">&#123;</div><div class="line">	//重置白点</div><div class="line">    [self resetWhitePoint];</div><div class="line">    //设置显示器参数</div><div class="line">    [self setGammaWithRed:redDim green:greenDim blue:blueDim];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>PS: redDim greenDim blueDim 分别为0-1之间的值，代表显示器的蒙版颜色</code></p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>我们打算创建一个slider,然后拖动slider的同时改变屏幕的亮度，将其逐渐降低到最低。下面开始实现。</p>
<p>1.新建一个工程项目，在主视图上添加一个UISlider，设置最小值为0，最大值为1，并进行简单的布局，如下图：<br><img src="https://ws1.sinaimg.cn/large/00663vn1ly1fhqc9nxhhsj31f010kag7.jpg" alt=""></p>
<p>2.为slider添加事件<code>- (IBAction)dimLevelChanged:(id)sender</code>，然后在viewcontroller中引入头文件<code>#import &quot;GammaController.h&quot;</code>.</p>
<p>3.在<code>- (IBAction)dimLevelChanged:(id)sender</code>中调用如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UISlider *slider = (UISlider *)sender;</div><div class="line">    [GammaController setDimWithRed:slider.value green:slider.value blue:slider.value];</div></pre></td></tr></table></figure>
<p>4.好的，Run 调节slider的值，你将会发现屏幕亮度随之发生了变化。</p>
<p><a href="https://github.com/yachaocn/adjust-brightness-lower-than-iOS-allow." target="_blank" rel="external">查看源码</a></p>
<p>如发现本文侵犯了您的知识产权请马上通知我:<code>zyachao@163.com</code>，我将在第一时间删除！</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/anthonya1999/GoodNight&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GoodNight&lt;/a&gt;:使用IOMobileFramebuffer调节显示器参数的App.能够实现以下功
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>webview缩放与样式</title>
    <link href="https://devchao.com/2017/07/20/webview%E7%BC%A9%E6%94%BE%E4%B8%8E%E6%A0%B7%E5%BC%8F/"/>
    <id>https://devchao.com/2017/07/20/webview缩放与样式/</id>
    <published>2017-07-20T06:45:20.000Z</published>
    <updated>2017-07-20T06:49:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>Webview添加缩放与外观样式</p>
<p>1.设置属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pibWebView.scalesPageToFit = YES;</div><div class="line">pibWebView.delegate = self;</div></pre></td></tr></table></figure>
<p>2.代理方法中添加如下JS代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (void)webViewDidFinishLoad:(UIWebView *)webView</div><div class="line">&#123;</div><div class="line">    //    yachaocn 2015年12月24日09:08:43</div><div class="line">    //js代码 写入缩放属性</div><div class="line">    NSString *jsMeta = [NSString stringWithFormat:@&quot;var meta = document.createElement(&apos;meta&apos;);meta.content=&apos;width=device-width,initial-scale=1.0,minimum-scale=.5,maximum-scale=3&apos;;meta.name=&apos;viewport&apos;;document.getElementsByTagName(&apos;head&apos;)[0].appendChild(meta);&quot;];</div><div class="line">    [webView stringByEvaluatingJavaScriptFromString:jsMeta];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>改变webview样式（也是模式）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//JS改变外观</div><div class="line">   if (isNightView) &#123;</div><div class="line">       //字体大小</div><div class="line">       //[webView stringByEvaluatingJavaScriptFromString:@&quot;document.getElementsByTagName(&apos;body&apos;)[0].style.webkitTextSizeAdjust= &apos;330%&apos;&quot;];</div><div class="line">       //字体颜色</div><div class="line">       [webView stringByEvaluatingJavaScriptFromString:@&quot;document.getElementsByTagName(&apos;body&apos;)[0].style.webkitTextFillColor= &apos;white&apos;&quot;];</div><div class="line">       //页面背景色 3c3f43</div><div class="line">       [webView stringByEvaluatingJavaScriptFromString:@&quot;document.getElementsByTagName(&apos;body&apos;)[0].style.background=&apos;#000000&apos;&quot;];</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>如发现本文侵犯了您的知识产权请马上通知我:<code>zyachao@163.com</code>，我将在第一时间删除！</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Webview添加缩放与外观样式&lt;/p&gt;
&lt;p&gt;1.设置属性&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>PlistBuddy的使用</title>
    <link href="https://devchao.com/2017/05/23/PlistBuddy%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>https://devchao.com/2017/05/23/PlistBuddy的使用/</id>
    <published>2017-05-23T14:19:21.000Z</published>
    <updated>2017-05-23T14:20:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PlistBuddy的使用"><a href="#PlistBuddy的使用" class="headerlink" title="PlistBuddy的使用"></a>PlistBuddy的使用</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>PlistBuddy是Mac系统自带的专门解析plist的小工具，可以很方便的对plist文件进行修改，对于批量修改plist是十分方便快捷的一种工具。</p>
<p>由于PlistBuddy并不在Mac默认的Path里，所以我们得通过绝对路径来引用这个工具：</p>
<p>查看帮助：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/libexec/PlistBuddy --help</div></pre></td></tr></table></figure>
<p>新建plist文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/libexec/PlistBuddy testing.plist</div></pre></td></tr></table></figure>
<p>查看plist</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Command: Print</div><div class="line">Dict &#123;</div></pre></td></tr></table></figure>
<p>在第一层添加一个键值对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Command: Add :Version string 1.0</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Version = 1.0</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在改变它的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Command: Set :Version 1.1</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Version = 1.1</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>接下来我们将创建一个数组，并放入一些数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Command: Add :Applications array</div><div class="line">Command: Add :Applications: string app1</div><div class="line">Command: Add :Applications: string app2</div><div class="line">Command: Add :Applications: string app3</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Version = 1.1</div><div class="line">    Applications = Array &#123;</div><div class="line">        app1</div><div class="line">        app2</div><div class="line">        app3</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们也可以在数组索引为0的位置插入一些数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Command: Add :Applications:0 string app0a</div><div class="line">Command: Add :Applications:0 string app0b</div><div class="line">Command: Add :Applications:0 string app0c</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Version = 1.1</div><div class="line">    Applications = Array &#123;</div><div class="line">        app0c</div><div class="line">        app0b</div><div class="line">        app0a</div><div class="line">        app1</div><div class="line">        app2</div><div class="line">        app3</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在我们将删除一个条目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Command: Delete :Applications</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Version = 1.1</div></pre></td></tr></table></figure>
<p>现在让我们创建一个更为复杂的数据结构吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">Command: Add :BrainCells integer 5</div><div class="line">Command: Add &quot;:Favourite Random Number&quot; real 3.9234</div><div class="line">Command: Add :Intelligent bool false</div><div class="line">Command: Add :Today date &quot;Sat Jun 27 18:51:00 AEST 2015&quot;</div><div class="line">Command: Add :Person dict</div><div class="line">Command: Add :Person:Name string &quot;Fotis Gimian&quot;</div><div class="line">Command: Add :Person:Occupation string &quot;Geek&quot;</div><div class="line">Command: Add :Person:Likes array</div><div class="line">Command: Add :Person:Likes: string Potatoes</div><div class="line">Command: Add :Person:Likes: string Apple</div><div class="line">Command: Add :Person:Likes: string Bouncing</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Favourite Random Number = 3.923400</div><div class="line">    Version = 1.1</div><div class="line">    Person = Dict &#123;</div><div class="line">        Likes = Array &#123;</div><div class="line">            Potatoes</div><div class="line">            Apple</div><div class="line">            Bouncing</div><div class="line">        &#125;</div><div class="line">        Name = Fotis Gimian</div><div class="line">        Occupation = Geek</div><div class="line">    &#125;</div><div class="line">    Intelligent = false</div><div class="line">    BrainCells = 5</div><div class="line">    Today = Sat Jun 27 18:51:00 AEST 2015</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在让我们调皮一下，让Microsoft取代Apple</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Command: Set :Person:Likes:1 Microsoft</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Favourite Random Number = 3.923400</div><div class="line">    Version = 1.1</div><div class="line">    Person = Dict &#123;</div><div class="line">        Likes = Array &#123;</div><div class="line">            Potatoes</div><div class="line">            Microsoft</div><div class="line">            Bouncing</div><div class="line">        &#125;</div><div class="line">        Name = Fotis Gimian</div><div class="line">        Occupation = Geek</div><div class="line">    &#125;</div><div class="line">    Intelligent = false</div><div class="line">    BrainCells = 5</div><div class="line">    Today = Sat Jun 27 18:51:00 AEST 2015</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们也可以打印一个子节点的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Command: Print :Person:Likes</div><div class="line">Array &#123;</div><div class="line">    Potatoes</div><div class="line">    Microsoft</div><div class="line">    Bouncing</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以使用索引移动到数组中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Command: Print :Person:Likes:1</div><div class="line">Microsoft</div></pre></td></tr></table></figure>
<p>当然了也可以使用冒号删除任何元组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Command: Delete :Person:Likes</div><div class="line">Command: Print</div><div class="line">Dict &#123;</div><div class="line">    Favourite Random Number = 3.923400</div><div class="line">    Version = 1.1</div><div class="line">    Person = Dict &#123;</div><div class="line">        Name = Fotis Gimian</div><div class="line">        Occupation = Geek</div><div class="line">    &#125;</div><div class="line">    Intelligent = false</div><div class="line">    BrainCells = 5</div><div class="line">    Today = Sat Jun 27 18:51:00 AEST 2015</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>也可以保存我们的辛苦工作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Command: Save</div><div class="line">Saving...</div><div class="line">Command: Exit</div></pre></td></tr></table></figure>
<p>可以使用-c选项直接从CLI调用这些命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">➔ /usr/libexec/PlistBuddy -c &quot;Print&quot; testing.plist</div><div class="line">Dict &#123;</div><div class="line">    Person = Dict &#123;</div><div class="line">        Name = Fotis Gimian</div><div class="line">        Occupation = Geek</div><div class="line">    &#125;</div><div class="line">    Intelligent = false</div><div class="line">    BrainCells = 5</div><div class="line">    Version = 1.1</div><div class="line">    Today = Sat Jun 27 18:51:00 AEST 2015</div><div class="line">    Favourite Random Number = 3.923400</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果您想修改应用程序提供的plist文件，则需要向PlistBuddy提供文件的完整路径名)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">➔ /usr/libexec/PlistBuddy -c &quot;Print :magnification&quot; ~/Library/Preferences/com.apple.dock.plist</div><div class="line">true</div><div class="line">➔ /usr/libexec/PlistBuddy -c &quot;Set :magnification bool false&quot; ~/Library/Preferences/com.apple.dock.plist</div><div class="line">➔ /usr/libexec/PlistBuddy -c &quot;Print :magnification&quot; ~/Library/Preferences/com.apple.dock.plist</div><div class="line">false</div></pre></td></tr></table></figure>
<p>小窍门：命令（即 Print, Set, Add等）不区分大小写，因此您可以使用小写字母键入。</p>
<p>翻译自<a href="http://fgimian.github.io/blog/2015/06/27/a-simple-plistbuddy-tutorial/" target="_blank" rel="external">http://fgimian.github.io/blog/2015/06/27/a-simple-plistbuddy-tutorial/</a></p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;PlistBuddy的使用&quot;&gt;&lt;a href=&quot;#PlistBuddy的使用&quot; class=&quot;headerlink&quot; title=&quot;PlistBuddy的使用&quot;&gt;&lt;/a&gt;PlistBuddy的使用&lt;/h1&gt;&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; cla
    
    </summary>
    
    
      <category term="Linux" scheme="https://devchao.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>EFB总结与启发</title>
    <link href="https://devchao.com/2017/05/21/EFB%E6%80%BB%E7%BB%93%E4%B8%8E%E5%90%AF%E5%8F%91/"/>
    <id>https://devchao.com/2017/05/21/EFB总结与启发/</id>
    <published>2017-05-21T14:39:39.000Z</published>
    <updated>2017-05-21T15:00:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>基于现在公司EFB项目的问题，查阅相关资料后针对某些问题写下如下不成熟的解决方案和启发,抛砖引玉。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>1.不发布app如何修改已发布版本的bug？</p>
<p>使用<a href="https://jspatch.com/" target="_blank" rel="external">JSPatch</a>,其实现原理为：开发者编写JS代码，并将JS代码上传服务器，APP自动下载到本地，JSPatch Engine将JS代码转换为OC代码，然后执行，从而实现修复线上bug。</p>
<p>代码派发示意图如下：<br><img src="https://ws1.sinaimg.cn/large/00663vn1gy1fftb349t9oj30qy0ragn6.jpg" alt=""></p>
<p> 至于为什么选择JSPatch请看<a href="https://devchao.com/2017/05/21/App%E7%83%AD%E6%9B%B4%E6%96%B0%E4%B9%8BJSPatch/">这篇文章</a></p>
<p> 其中服务器如何下发JS代码有以下2种方案：</p>
<ul>
<li>App在每次激活或者启动时下载JS代码，下载完成后执行代码,修复线上Bug。</li>
<li>Server通过Apple的APNS服务器推送<a href="https://devchao.com/2017/04/24/Silent-Remote-Notification/">静默通知</a>,APP后台静默下载补丁文件，下载完成后执行代码，修补线上Bug。</li>
</ul>
<p><code>下发代码时可根据设备的UDID实现以航空公司为单位批量修复Bug,想想都高兴</code></p>
<p>2.如何实现在后台配置APP图标，app下载后设置app图标 ,从而实现让航空公司自己配置自己公司APP的图标？</p>
<ul>
<li>首先Apple是不允许APP加载Bundle外的图片的，并且APP的Bundle是只读的,所以要想实现后台配置APP的icon，app的icon文件必须在APP Bundle中.故不能通过后台配置app图标，app下载后，从而加载app Icon。</li>
<li>其次我们虽然不能通过后台配置app图标，app下载后设置app图标，但是Apple允许我们在bundle中配置多个app图标，然后在app中切换他们，基于这一点我们可以为各个航空公司配置多个App图标，根据各自的喜好选择适合自己的。iOS设置APP icon技术实现:<a href="https://devchao.com/2017/05/15/change-app-icon/">https://devchao.com/2017/05/15/change-app-icon/</a></li>
</ul>
<h2 id="启发"><a href="#启发" class="headerlink" title="启发"></a>启发</h2><p>事件：上次因为飞行员临时更换飞机号，然后下载完的放行资料机号和排班中机号不一致问题。单单从测试方面我受到的启发有以下2点：</p>
<blockquote>
<p>测试数据</p>
<ul>
<li>公司测试环境上的数据够真实，但覆盖不够全面，只有覆盖全面的数据，才能编写功能覆盖全面的测试用例。因此应该搭建一整套覆盖所有功能模块的覆盖全面的测试数据，而非和航空公司一致的真实数据。</li>
</ul>
<p>测试方案</p>
<ul>
<li>基于覆盖全面的数据之上，应该编写一整套每一个功能模块的测试用例，并整理归档，新添加功能时，将当前功能所需的<code>数据</code>和<code>操作步骤</code>记录整理归档，并将测试数据更新到测试数据库，依次类推。。。每次测试只需根据现有的测试用例测试即可将所有功能测试完善。这样以来下次测试时，测试任务就会十分清晰，测试覆盖的功能就会相当完善；对于新入职的测试员工能够减少一定的培训的成本，并且能够让测试对自己的工作内容变得十分清晰。 </li>
</ul>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;基于现在公司EFB项目的问题，查阅相关资料后针对某些问题写下如下不成熟的解决方案和启发,抛砖引玉。&lt;/p&gt;
&lt;h2 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h2&gt;&lt;p&gt;1.不发布app如何修改已
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>App热更新之JSPatch</title>
    <link href="https://devchao.com/2017/05/21/App%E7%83%AD%E6%9B%B4%E6%96%B0%E4%B9%8BJSPatch/"/>
    <id>https://devchao.com/2017/05/21/App热更新之JSPatch/</id>
    <published>2017-05-21T14:32:28.000Z</published>
    <updated>2017-05-21T14:42:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>目前有以下几种个人觉得比较好的热更新方案(原理都是通过JS代码调用OC代码)：</p>
<ul>
<li><p><a href="https://facebook.github.io/react-native/" target="_blank" rel="external">React native</a>: ReactNative基于<a href="https://facebook.github.io/react/" target="_blank" rel="external">React</a>,安装配置麻烦，React native官方中文网提供的热更新组件<a href="https://github.com/reactnativecn/react-native-pushy" target="_blank" rel="external">react-native-pushy</a>可便捷实现热更新。首先你需要有一个基于React Native开发的应用，如果没有可参见<a href="https://facebook.github.io/react-native/docs/integration-with-existing-apps.html" target="_blank" rel="external">React native集成指南</a>集成到现有项目,再使用react-native-pushy。开发需要学习JSX模版。</p>
</li>
<li><p><a href="https://microsoft.github.io/code-push/docs/getting-started.html" target="_blank" rel="external">CodePush</a>: 针对<a href="https://facebook.github.io/react-native/" target="_blank" rel="external">React native</a>和<a href="https://cordova.apache.org/" target="_blank" rel="external">Cordova</a>的热更新方案。</p>
</li>
<li><a href="https://weex.apache.org/cn/" target="_blank" rel="external">Weex</a>:weex基于<a href="https://cn.vuejs.org/" target="_blank" rel="external">vue.js</a>, weex安装cli之后就可以使用，开发语法类似于普通的html，样式直接使用CSS。集成到现有项目参见<a href="https://weex.apache.org/cn/guide/integrate-to-your-app.html" target="_blank" rel="external">集成 Weex 到已有应用</a></li>
<li><a href="https://jspatch.com/" target="_blank" rel="external">JPatch</a>: JSPatch 是一个开源项目(<a href="https://github.com/bang590/JSPatch" target="_blank" rel="external">Github链接</a>)，只需要在项目里引入极小的引擎文件，就可以使用 JavaScript 调用任何 Objective-C 的原生接口，替换任意 Objective-C 原生方法。目前主要用于下发 JS 脚本替换原生 Objective-C 代码，实时修复线上 bug。具有以下优点:安全、快速、实时、简单。并且有代码补全工具<a href="https://github.com/bang590/JSPatchX" target="_blank" rel="external">JSPatchX</a>、OC到JS代码转换工具<a href="https://bang590.github.io/JSPatchConvertor/" target="_blank" rel="external">JSPatchConvertor</a>。</li>
<li><a href="https://github.com/DynamicCocoa/DynamicCocoa" target="_blank" rel="external">DynamicCocoa</a>:滴滴iOS的一个框架，准备开源，与JSPatch比更加智能化，用OC在XCode中写完代码，用工具可以自动生成可以更新的js文件。</li>
</ul>
<p>关于JSPatch与React native的比较可参见<a href="https://blog.cnbang.net/tech/3237/" target="_blank" rel="external">这篇文章</a>。</p>
<p>由于React native接入的复杂性、学习成本高(JSX)，DynamicCocoa没有开源，Weex使用html、CSS编写，个人又对JS、Html不太熟练，所以比较推荐iOS前端开发者JSPatch.</p>
<h2 id="JSPatch线上修复Bug示意"><a href="#JSPatch线上修复Bug示意" class="headerlink" title="JSPatch线上修复Bug示意"></a>JSPatch线上修复Bug示意</h2><p><img src="https://ws1.sinaimg.cn/large/00663vn1gy1fftb349t9oj30qy0ragn6.jpg" alt=""></p>
<h2 id="JSPatch-简单用法"><a href="#JSPatch-简单用法" class="headerlink" title="JSPatch 简单用法"></a>JSPatch 简单用法</h2><p>例如线上 APP 有一段代码出现 bug 导致 crash：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">@implementation JPTableViewController</div><div class="line">...</div><div class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath</div><div class="line">&#123;</div><div class="line">  NSString *content = self.dataSource[[indexPath row]];  //可能会超出数组范围导致crash</div><div class="line">  JPViewController *ctrl = [[JPViewController alloc] initWithContent:content];</div><div class="line">  [self.navigationController pushViewController:ctrl];</div><div class="line">&#125;</div><div class="line">...</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>可以通过下发这样一段 JS 代码，覆盖掉原方法，修复这个 bug：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">//JS</div><div class="line">defineClass(&quot;JPTableViewController&quot;, &#123;</div><div class="line">  //instance method definitions</div><div class="line">  tableView_didSelectRowAtIndexPath: function(tableView, indexPath) &#123;</div><div class="line">    var row = indexPath.row()</div><div class="line">    if (self.dataSource().length &gt; row) &#123;  //加上判断越界的逻辑</div><div class="line">      var content = self.dataArr()[row];</div><div class="line">      var ctrl = JPViewController.alloc().initWithContent(content);</div><div class="line">      self.navigationController().pushViewController(ctrl);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;, &#123;&#125;)</div></pre></td></tr></table></figure>
<p>其他高级用法详见<a href="https://github.com/bang590/JSPatch/wiki" target="_blank" rel="external">https://github.com/bang590/JSPatch/wiki</a></p>
<p><code>JSPatch</code> 提供了JSPatch SDK 提供了脚本后台托管，版本管理，保证传输安全等功能，让你无需搭建一个后台，无需关心部署操作，只需引入一个 SDK 即可立即使用 JSPatch,不过一些服务是收费的。</p>
<h2 id="JSPatch-SDK-与-github-上开源代码的关系？"><a href="#JSPatch-SDK-与-github-上开源代码的关系？" class="headerlink" title="JSPatch SDK 与 github 上开源代码的关系？"></a>JSPatch SDK 与 github 上开源代码的关系？</h2><p>Github 开源的是 JSPatch 核心代码，使用完全免费自由，若打算自己搭建后台下发 JSPatch 脚本，可以直接使用 github 上的核心代码，与 JSPatch 平台上的 SDK 无关。JSPatch 平台的 SDK 在核心代码的基础上增加了向平台请求脚本/传输解密/版本管理等功能，只用于这个平台。</p>
<p>##JSPatch SDK接入价格</p>
<p><img src="https://ws1.sinaimg.cn/large/00663vn1gy1ffsyhfflwcj31gy11o43t.jpg" alt="JSPatch价格"><br>觉得贵的可以搭建自己的后台。</p>
<p>本文摘录自：</p>
<ul>
<li><a href="https://facebook.github.io/react-native/" target="_blank" rel="external">https://facebook.github.io/react-native/</a></li>
<li><a href="https://microsoft.github.io/code-push/docs/getting-started.html" target="_blank" rel="external">https://microsoft.github.io/code-push/docs/getting-started.html</a></li>
<li><a href="https://weex.apache.org/cn/" target="_blank" rel="external">https://weex.apache.org/cn/</a></li>
<li><a href="https://jspatch.com/" target="_blank" rel="external">https://jspatch.com/</a></li>
</ul>
<p>如发现本文侵犯了您的知识产权请马上通知我:<code>zyachao@163.com</code>，我将在第一时间删除！</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;目前有以下几种个人觉得比较好的热更新方案(原理都是通过JS代码调用OC代码)：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://facebook.github.io/react-native/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Hexo自定义网站升级为https</title>
    <link href="https://devchao.com/2017/05/20/Hexo%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%AB%99%E5%8D%87%E7%BA%A7%E4%B8%BAhttps/"/>
    <id>https://devchao.com/2017/05/20/Hexo自定义网站升级为https/</id>
    <published>2017-05-20T05:09:20.000Z</published>
    <updated>2017-05-20T05:13:37.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近发现，各大网站好像已经开始全站使用HTTPS，看着浏览器地址栏左边有着一把绿色的小锁，好像是一件很酷的事情。国内的网络环境好像越来越差，除了学会科学上网之外，好像也难免会遇到通讯服务商在网站上加上小广告的问题。随着不断了解计算机的知识，安全概念也越来越重。看着某某网站又被脱裤，一不小心自己的隐私可能就泄露出去了。今天是周末，也想给自己的博客加上把绿色的小锁HTTPS。</p>
<h2 id="什么是HTTPS"><a href="#什么是HTTPS" class="headerlink" title="什么是HTTPS"></a>什么是HTTPS</h2><p>HTTPS全称Hypertext Transfer Protocol Secure 超文本安全协议。也就是HTTP加上安全传输层协议TSL/SSL。介于HTTP层与TCP层之间的一层安全协议。通过安全认证，可以避免HTTP中间人攻击，信息污染，信息劫持等问题。详细信息的话腾讯Bugly的文章<a href="https://segmentfault.com/a/1190000004199917" target="_blank" rel="external">全站HTTPS</a>来了介绍得很详细。HTTPS基础原理，通信过程，在这篇文章里都有详细地讲到。</p>
<h2 id="给博客加上HTTPS"><a href="#给博客加上HTTPS" class="headerlink" title="给博客加上HTTPS"></a>给博客加上HTTPS</h2><h3 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h3><p>通过上述的HTTPS介绍，可以知道如果我们要给让博客的协议变成HTTPS，就需要有CA认可的证书才可以，一般这样子的证书是需要自己进行购买和申请认证的。简单RSA非对称性的加密算法是无法避免中间人攻击的。存在着中间人攻击和信息抵赖的风险。所以我这里所采用的方法是用，<a href="https://www.cloudflare.com/" target="_blank" rel="external">Cloudflare</a>所提供的CDN来作为HTTPS的接入口。</p>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><p>什么是CDN? CDN的全称就是Content Delivery Network，内容分发网络。其最基本的思路就是，用户在访问一个网站的时候，不直接访问这个网站的服务器，CDN系统会根据地理位置，将用户重新导向离其最近的CDN服务器。网站的内容在这个CDN服务器上会有相应的缓存，从而使用户更快地访问到所需要的内容，可以减少网络拥堵的情况，也可以减轻网站的服务器承受太大的访问量，以及带宽不足的情况。</p>
<h3 id="主要步骤"><a href="#主要步骤" class="headerlink" title="主要步骤"></a>主要步骤</h3><ul>
<li>注册Cloudflare，添加个人网站，根据指引一步步添加自己的网站。</li>
<li>获取Cloudflare的<code>Domain Name Server</code>。(<code>alla.ns.cloudflare.com</code>和<code>vin.ns.cloudflare.com</code>)</li>
<li>在域名提供商处修改自己域名的<code>Domain Name Server</code>为2所获取的DNS</li>
<li><p>在Cloudflare &gt; DNS中添加三条如下记录：<br><img src="https://ws1.sinaimg.cn/large/00663vn1gy1ffrlruphkwj31i40c0jt7.jpg" alt=""></p>
<ul>
<li>A记录: 将一个域名指向一个ipv4的地址</li>
<li>AAAA记录: 将一个域名指向一个ipv6的地址</li>
<li>CNAME记录: 将一个域名指向另一个域名</li>
</ul>
<p><code>PS: 填写A记录时Name字段输入@就会显示为你的网址,我的是devchao.com,CNAME字段的Value字段需要填写为你需要只想的域名</code></p>
</li>
<li>更改Cloudflare &gt; Crypto &gt; SSL 选择 <code>Flexible</code>。(加密方式有三种：Flexible、Full SSL 、 Full SSL(strict),这里选择Flexible)</li>
<li>更改Cloudflare &gt; Crypto &gt; Automatic HTTPS Rewrites 打开开关</li>
</ul>
<h4 id="flexible的SSL加密方式解析"><a href="#flexible的SSL加密方式解析" class="headerlink" title="flexible的SSL加密方式解析"></a>flexible的SSL加密方式解析</h4><blockquote>
<p>There is an encrypted connection between your website visitors and Cloudflare, but not from Cloudflare to your server.</p>
<ul>
<li>There is an encrypted connection between your website visitors and Cloudflare, but not from Cloudflare to your server.</li>
<li>Visitors will see the SSL lock icon in their browser</li>
</ul>
</blockquote>
<p><img src="https://ws1.sinaimg.cn/large/00663vn1gy1ffrm2v8xz7j316i0r2q7a.jpg" alt=""></p>
<p><code>Flexible SSL</code> : 服务器与CDN在通信过程中的信息是没有加密的,因为我使用的git page 以及没有购买相应的证书，所以没法再服务器上部署SSL。所以CDN与服务器之间的通信就不是加密的通信。</p>
<ul>
<li>在cloudflare上的Page Rules设置中，添加上一条规则使得通过http协议的访问也会强制跳转到https上。<br><img src="https://ws1.sinaimg.cn/large/00663vn1gy1ffrm9w3d5nj317s0okad7.jpg" alt=""></li>
</ul>
<h3 id="全站https"><a href="#全站https" class="headerlink" title="全站https"></a>全站https</h3><p>要做到成功让这个博客满足https的要求，在博客所使用所有的图片自然也是要使用https的链接才行的，只要网站上所使用的资源不是全部通过https的就存在着安全的风险。且网站会被chrome等浏览器认为是不安全的。</p>
<p>这里所使用的是新浪微博的图床，在chrome商店可以找到对应的插件。在左下角有的https的选项，只要勾选上了就可以默认生成https的图片链接了。<br><img src="https://ws1.sinaimg.cn/large/00663vn1gy1ffrmfntohij31860u8whj.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;最近发现，各大网站好像已经开始全站使用HTTPS，看着浏览器地址栏左边有着一把绿色的小锁，好像是一件很酷的事情。国内的网络环境好像越来越差，
    
    </summary>
    
    
      <category term="Hexo" scheme="https://devchao.com/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>change-app-icon</title>
    <link href="https://devchao.com/2017/05/15/change-app-icon/"/>
    <id>https://devchao.com/2017/05/15/change-app-icon/</id>
    <published>2017-05-15T05:39:23.000Z</published>
    <updated>2017-05-15T06:45:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="change-app-icon"><a href="#change-app-icon" class="headerlink" title="change app icon"></a>change app icon</h1><p>本文教成将会一步步教你如何改变app图标，以下面两张图标(newicon2.png <code>120px X 120px</code> , newicon@2x.png <code>180px X 180px</code>)为例。</p>
<p><img src="http://7xiwr4.com1.z0.glb.clouddn.com/newicon2.png" alt="newicon2"></p>
<p><img src="http://7xiwr4.com1.z0.glb.clouddn.com/newicon@2x.png" alt="newicon"></p>
<hr>
<p><strong>1.设置plist:在info-plsit中的Source Code中添加如下键值对。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;CFBundleIcons&lt;/key&gt;</div><div class="line">	&lt;dict&gt;</div><div class="line">		&lt;key&gt;CFBundleAlternateIcons&lt;/key&gt;</div><div class="line">		&lt;dict&gt;</div><div class="line">			&lt;key&gt;newicon&lt;/key&gt;</div><div class="line">			&lt;dict&gt;</div><div class="line">				&lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">				&lt;array&gt;</div><div class="line">					&lt;string&gt;newicon&lt;/string&gt;</div><div class="line">				&lt;/array&gt;</div><div class="line">				&lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">				&lt;false/&gt;</div><div class="line">			&lt;/dict&gt;</div><div class="line">			&lt;key&gt;newicon2&lt;/key&gt;</div><div class="line">			&lt;dict&gt;</div><div class="line">				&lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">				&lt;array&gt;</div><div class="line">					&lt;string&gt;newicon2&lt;/string&gt;</div><div class="line">				&lt;/array&gt;</div><div class="line">				&lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">				&lt;false/&gt;</div><div class="line">			&lt;/dict&gt;</div><div class="line">		&lt;/dict&gt;</div><div class="line">		&lt;key&gt;CFBundlePrimaryIcon&lt;/key&gt;</div><div class="line">		&lt;dict&gt;</div><div class="line">			&lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">			&lt;array&gt;</div><div class="line">				&lt;string&gt;&lt;/string&gt;</div><div class="line">			&lt;/array&gt;</div><div class="line">			&lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">			&lt;false/&gt;</div><div class="line">		&lt;/dict&gt;</div><div class="line">	&lt;/dict&gt;</div></pre></td></tr></table></figure>
<p>配置好的Property plsit如下图:</p>
<p><img src="http://7xiwr4.com1.z0.glb.clouddn.com/changeAppIconPlist.png" alt="plist"></p>
<p><code>解释</code></p>
<ul>
<li>CFBundleAlternateIcons 代表要修改的图标键，是一个字典类型，其中的每一个字典代表一个item的描述。<code>并且这个字典的key必须是图片的名字，还要和CFBundleIconFiles的内容一样</code></li>
<li>UIPrerenderedIcon：指定应用程序的图标是否包含闪光效果（shine effect）,如果icon已经有这个效果，就把这个属性设置为YES来防止系统再次添加相同效果。如果设置为NO（默认值），iOS系统会自动添加这个效果。然而，并没有什么效果!!</li>
<li>CFBundleIcons 配置app的图标。如果你要适配ipad需要在plist中再次加入CFBundleIcons~ipad键，其他配置同上。</li>
</ul>
<p>我配置好的plist如下所示：</p>
<p><img src="http://7xiwr4.com1.z0.glb.clouddn.com/yachaocn-plist-appicon-ipad.png" alt="iapd-plist"></p>
<p><strong>2.调用Apple的API</strong></p>
<p>新建一个Single view application,在ViewController的View上添加一个Button添加一个事件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">- (IBAction)changeAppIcon:(id)sender &#123;</div><div class="line">    UIButton *button = (UIButton *)sender;</div><div class="line">    button.selected = !button.selected;</div><div class="line">    if (![self checkSuportChangeAppIcon]) &#123;//检查设备系统版本是否是iOS 10.3之后的</div><div class="line">        [self alertMessage:@&quot;Your system version was lower iOS 10.3.0,don&apos;t surport change app icon.&quot;];</div><div class="line">    &#125;</div><div class="line">    if (![UIApplication sharedApplication].supportsAlternateIcons) &#123;//检查app是否支持改变app icon</div><div class="line">         [self alertMessage:@&quot;Your application don&apos;t surport change app icon.&quot;];</div><div class="line">    &#125;</div><div class="line">    NSString *icon = button.selected ? @&quot;newicon&quot; : @&quot;newicon2&quot;;</div><div class="line">    </div><div class="line">    [self changeToIcon:icon];//该变app icon</div><div class="line">    </div><div class="line">  </div><div class="line">&#125;</div><div class="line"></div><div class="line">-(BOOL)checkSuportChangeAppIcon</div><div class="line">&#123;</div><div class="line">    NSString * systemVersion = [UIDevice currentDevice].systemVersion;</div><div class="line">    if ([systemVersion floatValue] &gt;= 10.3f) &#123;</div><div class="line">        return YES;</div><div class="line">    &#125;</div><div class="line">    return NO;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> 改变app icon</div><div class="line"></div><div class="line"> @param icon iconName</div><div class="line"> */</div><div class="line">-(void)changeToIcon:(NSString *)icon</div><div class="line">&#123;</div><div class="line">    [[UIApplication sharedApplication] setAlternateIconName:icon completionHandler:^(NSError * _Nullable error) &#123;</div><div class="line">        if (error) &#123;</div><div class="line">            [self alertMessage:error.description];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(void)alertMessage:(NSString *)message</div><div class="line">&#123;</div><div class="line">    UIAlertController *alertVC = [UIAlertController alertControllerWithTitle:@&quot;提示&quot; message:message preferredStyle:UIAlertControllerStyleAlert];</div><div class="line">    UIAlertAction *action = [UIAlertAction actionWithTitle:@&quot;好的&quot; style:UIAlertActionStyleDefault handler:nil];</div><div class="line">    [alertVC addAction:action];</div><div class="line">    [self presentViewController:alertVC animated:YES completion:nil];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="http://7xiwr4.com1.z0.glb.clouddn.com/ModifyAppIcons.zip" target="_blank" rel="external">下载代码</a></p>
<p>参考:</p>
<ul>
<li><a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-SW13" target="_blank" rel="external">官方文档</a></li>
<li><a href="http://www.cocoachina.com/ios/20170502/19152.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20170502/19152.html</a></li>
</ul>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;change-app-icon&quot;&gt;&lt;a href=&quot;#change-app-icon&quot; class=&quot;headerlink&quot; title=&quot;change app icon&quot;&gt;&lt;/a&gt;change app icon&lt;/h1&gt;&lt;p&gt;本文教成将会一步步教你如何改变app
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>CADisplayLink</title>
    <link href="https://devchao.com/2017/05/03/CADisplayLink/"/>
    <id>https://devchao.com/2017/05/03/CADisplayLink/</id>
    <published>2017-05-03T05:59:39.000Z</published>
    <updated>2017-05-03T06:00:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CADisplayLink"><a href="#CADisplayLink" class="headerlink" title="CADisplayLink"></a>CADisplayLink</h1><hr>
<p>##什么是CADisplayLink</p>
<p><code>CADisplayLink</code>是一个能让我们以和屏幕刷新率相同的频率将内容画到屏幕上的定时器。我们在应用中创建一个新的 <code>CADisplayLink</code> 对象，把它添加到一个<code>runloop</code>中，并给它提供一个 <code>target</code> 和<code>selector</code> 在屏幕刷新的时候调用。</p>
<p>一但 <code>CADisplayLink</code> 以特定的模式注册到<code>runloop</code>之后，每当屏幕需要刷新的时候，<code>runloop</code>就会调用<code>CADisplayLink</code>绑定的<code>target</code>上的<code>selector</code>，这时<code>target</code>可以读到 <code>CADisplayLink</code> 的每次调用的时间戳，用来准备下一帧显示需要的数据。例如一个视频应用使用时间戳来计算下一帧要显示的视频数据。在UI做动画的过程中，需要通过时间戳来计算UI对象在动画的下一帧要更新的大小等等。</p>
<p>在添加进<code>runloop</code>的时候我们应该选用高一些的优先级，来保证动画的平滑。可以设想一下，我们在动画的过程中，<code>runloop</code>被添加进来了一个高优先级的任务，那么，下一次的调用就会被暂停转而先去执行高优先级的任务，然后在接着执行<code>CADisplayLink</code>的调用，从而造成动画过程的卡顿，使动画不流畅。</p>
<p><code>duration</code>属性提供了每帧之间的时间，也就是屏幕每次刷新之间的的时间。我们可以使用这个时间来计算出下一帧要显示的UI的数值。但是<code>duration</code>只是个大概的时间，如果CPU忙于其它计算，就没法保证以相同的频率执行屏幕的绘制操作，这样会跳过几次调用回调方法的机会。</p>
<p><code>frameInterval</code>属性是可读可写的<code>NSInteger</code>型值，标识间隔多少帧调用一次<code>selector</code> 方法，默认值是<code>1</code>，即每帧都调用一次。如果每帧都调用一次的话，对于iOS设备来说那刷新频率就是60HZ也就是每秒60次，如果将 <code>frameInterval</code> 设为2 那么就会两帧调用一次，也就是变成了每秒刷新30次。<br>我们通过<code>pause</code>属性开控制<code>CADisplayLink</code>的运行。当我们想结束一个<code>CADisplayLink</code>的时候，应该调用<code>-(void)invalidate</code><br>从<code>runloop</code>中删除并删除之前绑定的 <code>target</code>跟<code>selector</code><br>另外<code>CADisplayLink</code> 不能被继承。</p>
<p>##CADisplayLink 与 NSTimer 有什么不同</p>
<p>iOS设备的屏幕刷新频率是固定的，CADisplayLink在正常情况下会在每次刷新结束都被调用，精确度相当高。</p>
<p><code>NSTimer</code>的精确度就显得低了点，比如<code>NSTimer</code>的触发时间到的时候，<code>runloop</code>如果在阻塞状态，触发时间就会推迟到下一个<code>runloop</code>周期。并且 <code>NSTimer</code>新增了<code>tolerance</code>属性，让用户可以设置可以容忍的触发的时间的延迟范围。</p>
<p><code>CADisplayLink</code>使用场合相对专一，适合做UI的不停重绘，比如自定义动画引擎或者视频播放的渲染。NSTimer的使用范围要广泛的多，各种需要单次或者循环定时处理的任务都可以使用。在UI相关的动画或者显示内容使用 <code>CADisplayLink</code>比起用<code>NSTimer</code>的好处就是我们不需要在格外关心屏幕的刷新频率了，因为它本身就是跟屏幕刷新同步的。</p>
<p>##CADisplayLink使用的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">self.displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(updateTextColor)];</div><div class="line">self.displayLink.paused = YES;</div><div class="line">[self.displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];</div><div class="line">-(void)updateTextColor&#123;&#125;</div><div class="line">- (void)startAnimation&#123;</div><div class="line">   self.beginTime = CACurrentMediaTime();</div><div class="line">   self.displayLink.paused = NO;</div><div class="line">&#125;</div><div class="line">- (void)stopAnimation&#123;</div><div class="line">  self.displayLink.paused = YES;</div><div class="line">  [self.displayLink invalidate];</div><div class="line">  self.displayLink = nil;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##给非UI对象添加动画效果</p>
<p>我们知道动画效果就是一个属性的线性变化，比如UIView 动画的 EasyIn EasyOut 。通过数值按照不同速率的变化我们能生成更接近真实世界的动画效果。我们也可以利用这个特性来使一些其他属性按照我们期望的曲线变化。比如当播放视频时关掉视频的声音我可以通过CADisplayLink来实现一个 EasyOut的渐出效果：先快速的降低音量，在慢慢的渐变到静音。</p>
<p>##注意</p>
<p>通常来讲：iOS设备的刷新频率事60HZ也就是每秒60次。那么每一次刷新的时间就是1/60秒 大概16.7毫秒。当我们的frameInterval值为1的时候我们需要保证的是 CADisplayLink调用的｀target｀的函数计算时间不应该大于 16.7否则就会出现严重的丢帧现象。</p>
<p>在mac应用中我们使用的不是CADisplayLink而是 CVDisplayLink它是基于C接口的用起来配置有些麻烦但是用起来还是很简单的。</p>
<p><a href="https://developer.apple.com/library/ios/samplecode/AVBasicVideoOutput/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013109" target="_blank" rel="external">apple官方DEMO</a></p>
<p><a href="https://developer.apple.com/library/ios/documentation/QuartzCore/Reference/CADisplayLink_ClassRef/index.html" target="_blank" rel="external">CADisplayLink Class Reference</a></p>
<p><a href="https://github.com/zipme/RQShineLabel" target="_blank" rel="external">一个文字渐变效果的动画开源库</a></p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CADisplayLink&quot;&gt;&lt;a href=&quot;#CADisplayLink&quot; class=&quot;headerlink&quot; title=&quot;CADisplayLink&quot;&gt;&lt;/a&gt;CADisplayLink&lt;/h1&gt;&lt;hr&gt;
&lt;p&gt;##什么是CADisplayLink&lt;/p
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Silent-Remote-Notification</title>
    <link href="https://devchao.com/2017/04/24/Silent-Remote-Notification/"/>
    <id>https://devchao.com/2017/04/24/Silent-Remote-Notification/</id>
    <published>2017-04-24T04:59:38.000Z</published>
    <updated>2017-04-24T05:00:10.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iOS-Silent-Remote-Notification"><a href="#iOS-Silent-Remote-Notification" class="headerlink" title="iOS Silent Remote Notification"></a>iOS Silent Remote Notification</h1><p>###官方是这么概述的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Silent notifications improve the user experience by helping you keep your app up-to-date, even when it is not running. When apps do not run for extended periods of time, their data can become outdated. When the user finally launches the app again, the outdated data must be replaced, which can cause a delay in using the app. Silent notifications give you a way to wake up your app periodically so that it can refresh its data in the background.</div></pre></td></tr></table></figure>
<p>大概意思是说：当app处于前台、后台、甚至不再运行时，静默通知都可以实时更新你的APP，以此来提高用户的体验。当app很长一段时间不再运行时，他的数据就回变旧，此时当用户进入你的app中时，旧的数据需要被替换掉，这会让用户等待，降低了用户体验。怎么解决这个问题呢？静默通知可以解决。静默通知可以定期唤醒你的app,以便与可以在后台刷新数据。</p>
<p><code>IMPORTANT:静音通知并不意味着可以保持您的应用在后台醒来后一直处于后台，也不用于高优先级更新。 APN将无声通知视为低优先级，并且如果总数变得过多，则可以完全抑制它们的传送。实际的限制是动态的，可以根据条件改变，但尽量不要每小时发送多个通知</code></p>
<p>发送静默通知需要对通知的有效内容进行特殊配置。如果您payload(后台推送内容)未正确配置，通知可能会显示给用户，而不是在后台传递到您的应用程序。payload配置如下：</p>
<ul>
<li>payload的<code>aps</code>字典必须包含<code>content-available</code>键，并且其值必须为1；</li>
<li>payload的<code>aps</code>字典禁止包含alert, sound,活着 badge键</li>
</ul>
<p><strong>静默通知payload实例</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;aps&quot; : &#123;</div><div class="line">        &quot;content-available&quot; : 1</div><div class="line">    &#125;,</div><div class="line">    &quot;acme1&quot; : &quot;bar&quot;,</div><div class="line">    &quot;acme2&quot; : 42</div><div class="line">&#125;</div><div class="line">``` </div><div class="line">**正常通知payload实例**</div></pre></td></tr></table></figure>
<p>{<br>    “aps” : {<br>        “alert” : {<br>            “title” : “Game Request”,<br>            “body” : “Bob wants to play poker”,<br>            “action-loc-key” : “PLAY”<br>        },<br>        “badge” : 5<br>    },<br>    “acme1” : “bar”,<br>    “acme2” : [ “bang”,  “whiz” ]<br>}</p>
<p>或：</p>
<p>{<br>    “aps” : {<br>        “alert” : “You got your emails.”,<br>        “badge” : 9,<br>        “sound” : “bingbong.aiff”<br>    },<br>    “acme1” : “bar”,<br>    “acme2” : 42<br>}</p>
<p>```</p>
<p>当静默通知被传送给app后，iOS会在后台唤醒你的app，并给出30秒时间去运行，在iOS系统中，系统将会通过app代理调用<code>application:didReceiveRemoteNotification:fetchCompletionHandler:</code>来传送静默通知，使用该方法启动获取新数据所需的一些下载操作。在后台处理远程通知需要您向应用程序添加适当的后台模式。</p>
<p>####将应用配置为在后台处理无提示通知</p>
<p>1.在Project Navigator中选中你的项目。</p>
<p>2.在editor中选中你的target。</p>
<p>3.选中Capabilities。</p>
<p>4.打开Background Modes开关。</p>
<p>5.勾选Remote notifications复选框。</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;iOS-Silent-Remote-Notification&quot;&gt;&lt;a href=&quot;#iOS-Silent-Remote-Notification&quot; class=&quot;headerlink&quot; title=&quot;iOS Silent Remote Notification&quot;&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Apache服务配置</title>
    <link href="https://devchao.com/2017/04/15/Apache%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE/"/>
    <id>https://devchao.com/2017/04/15/Apache服务配置/</id>
    <published>2017-04-15T02:04:35.000Z</published>
    <updated>2017-04-15T04:09:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mac-OS-Apache-服务配置"><a href="#Mac-OS-Apache-服务配置" class="headerlink" title="Mac OS Apache 服务配置"></a>Mac OS Apache 服务配置</h1><p><strong>Apache 所在位置</strong>:<code>/etc/apache2</code></p>
<p><strong>Apache 配置文件所在位置</strong>:<code>/etc/apache2/httpd.conf</code></p>
<p>###apache下部署web资源</p>
<p>跟windows不一样，它的部署包不是放在htdocs(windows下的存放目录),而是放在 “/资源库/WebServer/Documents/”下面,我们的静态资源就可以丢到这个目录.这个目录是apache的默认目录，有时候为了方便操作，可能需要指向特定的文件夹，该如何修改apache的配置呢？</p>
<p>###修改默认部署路径</p>
<p>找到Apache配置文件中的<code>DocumentRoot</code>,将其配置目录改为制定路径即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DocumentRoot /Library/WebServer/Documents</div></pre></td></tr></table></figure>
<p>###修改apache默认端口<br>找到Apache配置文件中<code>Listen</code>,更改为想要的端口即可。 </p>
<p>###启动停用apache</p>
<p>启用apache的命令：<code>sudo apachectl start/restart</code></p>
<p>在浏览器中输入localhost或者127.0.0.1即可看到“It works!”的提示。那么，apache就启动成功了！</p>
<p>停止apache的命令：<code>sudo apachectl stop</code></p>
<p>apache的用法还有非常多，比如 转发配置、ssl配置、日志配置，以后慢慢补充～</p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Mac-OS-Apache-服务配置&quot;&gt;&lt;a href=&quot;#Mac-OS-Apache-服务配置&quot; class=&quot;headerlink&quot; title=&quot;Mac OS Apache 服务配置&quot;&gt;&lt;/a&gt;Mac OS Apache 服务配置&lt;/h1&gt;&lt;p&gt;&lt;stron
    
    </summary>
    
    
      <category term="Linux" scheme="https://devchao.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>内敛函数</title>
    <link href="https://devchao.com/2017/04/10/%E5%86%85%E6%95%9B%E5%87%BD%E6%95%B0/"/>
    <id>https://devchao.com/2017/04/10/内敛函数/</id>
    <published>2017-04-10T09:52:18.000Z</published>
    <updated>2017-04-10T09:59:34.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="内联函数inline"><a href="#内联函数inline" class="headerlink" title="内联函数inline"></a>内联函数inline</h1><p><code>参考资料</code></p>
<p><a href="http://www.jianshu.com/p/d557b0831c6a" target="_blank" rel="external">http://www.jianshu.com/p/d557b0831c6a</a></p>
<p><a href="http://www.blogfshare.com/ioss-static-inline.html" target="_blank" rel="external">http://www.blogfshare.com/ioss-static-inline.html</a></p>
<p><a href="http://www.blogfshare.com/ioss-static-inline.html" target="_blank" rel="external">http://www.blogfshare.com/ioss-static-inline.html</a></p>
<p><code>例：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">static inline UIBarButtonItem *UIBarButtonWithFixedWidth(CGFloat with)</div><div class="line">&#123;</div><div class="line">    UIBarButtonItem *button = [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];</div><div class="line">    button.width = with;</div><div class="line">    return button;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>概述：</code></p>
<p>内联函数是一种小型函数，是以空间换效率的函数，功能较简单，他能够替代宏，static inline通常用于修饰函数或者方法，用于解决函数调用的效率问题：</p>
<ul>
<li><p>函数调用是内存地址之间通过call的方式调用,当函数调用完毕之后还会返回原来函数执行的地址,函数调用有时间开销, 汇编时会出现 call 指令.调用call指令就是就需要：</p>
<ul>
<li>(1)将下一条指令的所在地址入栈</li>
<li>(2)并将子程序的起始地址送入PC（于是CPU的下一条指令就会转去执行子程序）</li>
</ul>
</li>
<li><p>以inline的方式编译的会，会把该函数的code拷贝到每次调用该函数的地方。而static会让生成的二进制文件中没有清晰的符号表，让逆向的人很难弄清楚逻辑。</p>
</li>
</ul>
<p>inline 的优点：</p>
<p><strong><code>相比函数</code></strong></p>
<ul>
<li><p>inline函数避免了普通函数的,在汇编时必须调用call的缺点:取消了函数的参数压栈，减少了调用的开销,提高效率.所以执行速度确比一般函数的执行速度要快.</p>
</li>
<li><p>集成了宏的优点,使用时直接用代码替换(像宏一样);</p>
</li>
<li>以inline的方式编译的会，会把该函数的code拷贝到每次调用该函数的地方。而static会让生成的二进制文件中没有清晰的符号表，让逆向的人很难弄清楚逻辑。</li>
</ul>
<p><strong><code>相比宏</code></strong></p>
<ul>
<li><p>避免了宏的缺点:需要预编译.因为inline内联函数也是函数,不需要预编译.</p>
</li>
<li><p>编译器在调用一个内联函数时，会首先检查它的参数的类型，保证调用正确。然后进行一系列的相关检查，就像对待任何一个真正的函数一样。这样就消除了它的隐患和局限性。</p>
</li>
<li><p>可以使用所在类的保护成员及私有成员</p>
</li>
</ul>
<p><code>使用内敛函数注意事项：</code></p>
<ul>
<li>内联函数只是我们向编译器提供的申请,编译器不一定采取inline形式调用函数.</li>
<li>内联函数不能承载大量的代码.如果内联函数的函数体过大,编译器会自动放弃内联.</li>
<li>内联函数内不允许使用循环语句或开关语句.</li>
<li>内联函数的定义须在调用之前.</li>
</ul>
<hr>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;内联函数inline&quot;&gt;&lt;a href=&quot;#内联函数inline&quot; class=&quot;headerlink&quot; title=&quot;内联函数inline&quot;&gt;&lt;/a&gt;内联函数inline&lt;/h1&gt;&lt;p&gt;&lt;code&gt;参考资料&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http
    
    </summary>
    
    
      <category term="iOS" scheme="https://devchao.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>MAC SSH 服务</title>
    <link href="https://devchao.com/2017/03/28/MAC-SSH-%E6%9C%8D%E5%8A%A1/"/>
    <id>https://devchao.com/2017/03/28/MAC-SSH-服务/</id>
    <published>2017-03-28T06:23:23.000Z</published>
    <updated>2017-03-28T06:23:57.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MAC-SSH-服务"><a href="#MAC-SSH-服务" class="headerlink" title="MAC SSH 服务"></a>MAC SSH 服务</h1><p>SSH（Secure Shell）是一种通用的、功能强大的、基于软件的网络安全解决方案。计算机每次向网络发送数据时，SSH都会自动对其进行加密。运行 OS X 又或者是 macOS 的较新 Mac 设备都会默认预装 SSH，不过 SSH 守护进程是默认禁用的。</p>
<blockquote>
<p>配置</p>
</blockquote>
<p><code>Mac Terminal是自带SSH的，可以用whereis来看看：</code></p>
<pre><code>$ whereis ssh
</code></pre><p>但是在现有进程中找不到ssh对应的进程：</p>
<pre><code>$ ps aux | grep ssh
yachaocn          9043   0.0  0.0  2434840    764 s001  R+    3:52下午   0:00.00 grep --color=auto --exclude-dir=.bzr --exclude-dir=.cvs --exclude-dir=.git --exclude-dir=.hg --exclude-dir=.svn ssh
</code></pre><p>直接用ssh命令连接本地主机或远程主机时会遇到下列错误提示：</p>
<pre><code>ssh: connect to host localhost port 22: Connection refused
</code></pre><p><strong>解决办法:</strong></p>
<p> 在系统偏好设置》共享》勾选‘远程登陆’或者 终端键入如下命令:</p>
<p><code>查看SSH服务状态</code></p>
<pre><code>$ sudo systemsetup -getremotelogin
</code></pre><p><code>快速开启 SSH 服务器并允许 SSH 连接进入当前 Mac</code></p>
<pre><code>$ sudo systemsetup -setremotelogin on
</code></pre><p>输入指令后并没有任何确认信息表明远程登录和 SSH 已经开启，但你可以使用上文提到的方法来检查是否开启成功。</p>
<p><code>通过终端指令关闭Mac的SSH,并阻止远程连接</code></p>
<pre><code>$ sudo systemsetup -setremotelogin off
</code></pre><blockquote>
<p>使用</p>
</blockquote>
<p><code>ssh链接远程电脑</code></p>
<pre><code>ssh username@192.168.100.100
</code></pre><p>username ： 登录的主机的用户名</p>
<p>192.168.100.100 ：要登录的主机的IP地址</p>
<p><code>scp远程copy文件</code></p>
<pre><code>scp .zshrc username@192.168.100.100:/Users/username/
</code></pre><p>将当前路径下的.zshrc文件复制到远程主机的/Users/username目录下。</p>
<p><strong>具体用法参见</strong><br><a href="http://yachaocn.com/2017/03/23/Linux-cp%E5%92%8Cscp%E5%91%BD%E4%BB%A4/" target="_blank" rel="external">cp和scp用法</a></p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;MAC-SSH-服务&quot;&gt;&lt;a href=&quot;#MAC-SSH-服务&quot; class=&quot;headerlink&quot; title=&quot;MAC SSH 服务&quot;&gt;&lt;/a&gt;MAC SSH 服务&lt;/h1&gt;&lt;p&gt;SSH（Secure Shell）是一种通用的、功能强大的、基于软件的网络安
    
    </summary>
    
    
      <category term="Linux" scheme="https://devchao.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>毛玻璃效果的实现</title>
    <link href="https://devchao.com/2017/03/23/%E6%AF%9B%E7%8E%BB%E7%92%83%E6%95%88%E6%9E%9C%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <id>https://devchao.com/2017/03/23/毛玻璃效果的实现/</id>
    <published>2017-03-23T09:36:03.000Z</published>
    <updated>2017-03-23T09:36:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>####制作毛玻璃效果</p>
<p>1.加入属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@property (nonatomic, strong) UIVisualEffectView *visualEfView;</div></pre></td></tr></table></figure>
<p>2.添加图片</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height)];</div><div class="line">    [imageView setImage:[UIImage imageNamed:@&quot;1.jpg&quot;]];</div></pre></td></tr></table></figure>
<p>3.添加毛玻璃效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">self.visualEfView = [[UIVisualEffectView alloc] initWithEffect:[UIBlurEffect effectWithStyle:UIBlurEffectStyleLight]];</div><div class="line">    _visualEfView.frame = CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height/2);</div><div class="line">    _visualEfView.alpha = 0.9;</div><div class="line">    [imageView addSubview:_visualEfView];</div><div class="line">    </div><div class="line">    [self.view addSubview:imageView];</div></pre></td></tr></table></figure>
<p><strong>运行试一下吧</strong></p>
<p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;####制作毛玻璃效果&lt;/p&gt;
&lt;p&gt;1.加入属性&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td 
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux cp和scp命令</title>
    <link href="https://devchao.com/2017/03/23/Linux-cp%E5%92%8Cscp%E5%91%BD%E4%BB%A4/"/>
    <id>https://devchao.com/2017/03/23/Linux-cp和scp命令/</id>
    <published>2017-03-23T09:31:58.000Z</published>
    <updated>2017-03-23T09:32:27.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Linux-cp和scp命令"><a href="#Linux-cp和scp命令" class="headerlink" title="Linux cp和scp命令"></a>Linux cp和scp命令</h1><p>Linux为我们提供了两个用于文件copy的命令，一个是cp，一个是scp，但是他们略有不同:</p>
<ul>
<li>cp — 主要是用于在同一台电脑上，在不同的目录之间来回copy文件 </li>
<li>scp — 主要是在不同的Linux系统之间来回copy文件 </li>
</ul>
<p>##cp<br></p>
<p>详细见</p>
<pre><code>$ man 1 cp
</code></pre><p>cp [OPTIONS] SOURCE DEST — 从源路径copy文件到目的路径 </p>
<p>cp [OPTIONS] SOURCE… DIRECTORY — 将多个源文件copy到指定的目录（多个源文件用空格分隔</p>
<p><code>OPTIONS：</code> </p>
<p><code>-a</code> same as -dpR 尽可能将源文件状态、权限等资料都照原装予以复制，并且是递归copy；</p>
<p><code>-r</code> 表示递归copy，若source中含有目录名，则将目录下之档案亦皆依序拷贝至目的地； </p>
<p><code>-f</code> 表示force，若目的地已经有相同档名的档案存在，则在复制前先予以删除再行复制； </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">范例： </div><div class="line"></div><div class="line">1. 将档案 aaa 复制(已存在)，并命名为 bbb： </div><div class="line">cp aaa bbb </div><div class="line">2. 将所有的C语言程式拷贝至 Finished 子目录中： </div><div class="line">cp *.c Finished/</div></pre></td></tr></table></figure>
<p>##scp<br><br><br>scp是有Security的文件copy，基于ssh登录。操作起来比较方便，比如要把当前一个文件copy到远程另外一台主机上，可以如下命令：</p>
<pre><code>$scp /home/daisy/full.tar.gz root@172.19.2.75:/home/root 
</code></pre><p><code>命令基本格式：</code></p>
<p>scp [OPTIONS] file_source file_target </p>
<p><code>从本地复制到远程</code></p>
<pre><code>$ scp local_file remote_username@remote_ip:remote_folder 
$ scp local_file remote_ip:remote_file 
</code></pre><p><code>从远程复制到本地</code></p>
<pre><code>scp root@www.cumt.edu.cn:/home/root/others/music /home/space/music/1.mp3 
scp -r www.cumt.edu.cn:/home/root/others/ /home/space/music/ 
</code></pre><p><code>复制目录</code>: OPTIONS 填入 <code>-r</code>即可</p>
<p>完整格式：<strong>scp [本地用户名]@[IP地址]:[文件名1] [远程用户名]@[IP地址]:[文件名2] 
</strong></p>
<p><code>本地用户名@IP地址:</code>可以不输入,可能需要输入远程用户名所对应的密码.</p>
<p><code>[OPTIONS]</code></p>
<p>-v 和大多数 linux 命令中的 -v 意思一样 , 用来显示进度 . 可以用来查看连接 , 认证 , 或是配置错误 . </p>
<p>-C 使能压缩选项 . </p>
<p>-P 选择端口 . 注意 -p 已经被 rcp 使用 . </p>
<p>-4 强行使用 IPV4 地址 . </p>
<p>-6 强行使用 IPV6 地址 .</p>
<pre><code>注意两点： 
1.如果远程服务器防火墙有特殊限制，scp便要走特殊端口，具体用什么端口视情况而定，命令格式如下： 
#scp -p 4588 remote@www.abc.com:/usr/local/sin.sh /home/administrator 
2.使用scp要注意所使用的用户是否具有可读取远程服务器相应文件的权限。
</code></pre><p><code>技术交流群:</code><strong>494826724</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Linux-cp和scp命令&quot;&gt;&lt;a href=&quot;#Linux-cp和scp命令&quot; class=&quot;headerlink&quot; title=&quot;Linux cp和scp命令&quot;&gt;&lt;/a&gt;Linux cp和scp命令&lt;/h1&gt;&lt;p&gt;Linux为我们提供了两个用于文件copy的
    
    </summary>
    
    
      <category term="Linux" scheme="https://devchao.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>duoshuo</title>
    <link href="https://devchao.com/2017/03/23/duoshuo/"/>
    <id>https://devchao.com/2017/03/23/duoshuo/</id>
    <published>2017-03-23T06:43:04.000Z</published>
    <updated>2017-03-23T06:46:35.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>‘多说’评论界的老大，一路走好，不舍。<br><br><br><br><br>2017-3-21</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;‘多说’评论界的老大，一路走好，不舍。&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;2017-3-21&lt;/p&gt;
&lt;/blockquote&gt;

    
    </summary>
    
    
      <category term="随笔" scheme="https://devchao.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
</feed>
